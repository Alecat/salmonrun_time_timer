!function(e){var t={};function n(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./main.js")}({"../node_modules/get-json-data/index.js":
/*!**********************************************!*\
  !*** ../node_modules/get-json-data/index.js ***!
  \**********************************************/
/*! no static exports found */function(e,t){!function(){var t=function(e,t,n){var i;if(XMLHttpRequest)i=new XMLHttpRequest;else if(ActiveXObject)try{i=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{i=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}if(!i)return t.call(this,"Giving up :( Cannot create an XMLHTTP instance",null),!1;i.onreadystatechange=function(){if(4===i.readyState)if(i.status>=200&&i.status<400){var e=i.responseText;if(!(!(!n||!n.hasOwnProperty("raw"))&&n.raw))try{e=JSON.parse(e)}catch(e){return void t.call(this,e,null)}t.call(this,null,e)}else t.call(this,new Error("There was a problem with the request"),null)};var s=n&&n.method?n.method:"GET";if("GET"==s){var o=[];if(n&&n.params&&"object"==typeof n.params)for(var a in n.params)o.push(a+"="+encodeURIComponent(n.params[a]));e=o.length>0?e+"?"+o.join("&"):e,i.open("GET",e),i.send()}else if("POST"==s){var r=n&&n.data?n.data:n.params?n.params:{};i.open("POST",e),i.send(JSON.stringify(r))}return i};void 0!==e&&e.exports&&(e.exports=t),"undefined"!=typeof window&&(window.getJSONData=t)}()},"./config.js":
/*!*******************!*\
  !*** ./config.js ***!
  \*******************/
/*! exports provided: default */function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.r(t);var s=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.listener=t,this.scheme=n}return function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(e,[{key:"load",value:function(){var e=this;this.scheme;Object.keys(this.scheme).forEach(function(t){var n=e.scheme[t],i=n.type,s=localStorage[t];void 0!==s&&null!==s||(s=n.default),i===Boolean?e[t]="true"==s||1==s:i===Number?e[t]=Number(s):i===String?e[t]=String(s):e[t]=s},this),this.listener&&this.listener(this)}},{key:"save",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;t?Object.keys(t).forEach(function(n){localStorage[n]=t[n],e[n]=t[n]}):Object.keys(this.scheme).forEach(function(t){localStorage[t]=e[t]})}}]),e}();t.default=s},"./date_formatter.js":
/*!***************************!*\
  !*** ./date_formatter.js ***!
  \***************************/
/*! exports provided: default */function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.r(t);var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(e,[{key:"getMonthText",value:function(e){var t=e.getMonth()+1,n=e.getDate();t<10&&(t="0"+t),n<10&&(n="0"+n);var i=e.getHours(),s=e.getMinutes(),o=e.getSeconds();return i<10&&(i="0"+i),s<10&&(s="0"+s),o<10&&(o="0"+o),t+"/"+n+" "+i+":"+s+":"+o}},{key:"getMinText",value:function(e){var t=e.getMinutes(),n=e.getSeconds(),i=e.getMilliseconds();return t<10&&(t="0"+t),n<10&&(n="0"+n),i<10?i="00"+i:i<100&&(i="0"+i),t+":"+n+"."+i}}]),e}();t.default=s},"./main.js":
/*!*****************!*\
  !*** ./main.js ***!
  \*****************/
/*! no exports provided */function(e,t,n){"use strict";n.r(t);var i=n(/*! ./salmonrun_time_timer */"./salmonrun_time_timer.js"),s=n(/*! ./date_formatter */"./date_formatter.js"),o=n(/*! ./time_offset */"./time_offset.js"),a=n(/*! ./config */"./config.js");function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var l=new s.default,f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time_offset=new o.default,this.timer=new i.default(this.time_offset),this.config=new a.default(this.on_load.bind(this),{mode_friend:{type:Boolean,default:!1},mode_frequency_update:{type:Boolean,default:!1}}),this.elmEta=document.getElementById("eta"),this.elmEtaArea=document.getElementById("eta_area"),this.elmEtaLabel=document.getElementById("eta_label"),this.elmOffset=document.getElementById("offset"),this.elmModeFriend=document.getElementById("mode_friend"),this.elmModeFriend.onclick=this.on_change_modeFriend.bind(this),this.elmModeFrequencyUpdate=document.getElementById("mode_frequency_update"),this.elmModeFrequencyUpdate.onclick=this.on_change_modeFrequencyUpdate.bind(this),this.config.load(),this.update(!0)}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(e,[{key:"calc_eta",value:function(){this.list=this.timer.listup_next_STT();var e=this.time_offset.get_time(),t=this.list[0]-e;this.eta=new Date(t)}},{key:"update_eta",value:function(){var e=l.getMinText(this.eta);this.elmEta.innerHTML=e;var t="ST";if(0!=this.time_offset.offset_friend&&(t+="(フレ部屋)"),t+="まで",this.elmEtaLabel.innerHTML=t,this.time_offset.offset_jst){var n="補正: ";this.time_offset.offset_jst<0?n+="-"+l.getMinText(new Date(-this.time_offset.offset_jst)):n+="+"+l.getMinText(new Date(this.time_offset.offset_jst)),0!=this.time_offset.offset_friend&&(n+=" (2秒遅れ)"),this.elmOffset.innerHTML=n}else this.elmOffset.innerHTML="時刻合わせ中 ..."}},{key:"update_list",value:function(){for(var e in this.list){var t=document.getElementById("stt-item-"+(Number(e)+1)),n=l.getMonthText(this.list[e]);t.innerHTML=n}}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.calc_eta(),this.update_eta(),this.update_list();var t=this.config.mode_frequency_update;if(e){this.timeout&&clearTimeout(this.timeout);var n=1e3;(t||this.eta<6e4)&&(n=50),this.timeout=setTimeout(this.update.bind(this,!0),n)}}},{key:"on_load",value:function(e){this.elmModeFriend.checked=e.mode_friend,this.elmModeFrequencyUpdate.checked=e.mode_frequency_update,this.on_change_modeFriend(),this.on_change_modeFrequencyUpdate()}},{key:"on_change_modeFriend",value:function(){var e=this.elmModeFriend.checked;this.elmEtaArea.classList.remove("mdl-color--grey-800"),this.elmEtaArea.classList.remove("mdl-color--green-900"),this.elmEtaLabel.classList.remove("mdl-color-text--grey-600"),this.elmEtaLabel.classList.remove("mdl-color-text--yellow-600"),this.elmOffset.classList.remove("mdl-color-text--grey-600"),this.elmOffset.classList.remove("mdl-color-text--yellow-600"),e?(this.time_offset.set_offset_friend(-2e3),this.elmEtaArea.classList.add("mdl-color--green-900"),this.elmEtaLabel.classList.add("mdl-color-text--yellow-600"),this.elmOffset.classList.add("mdl-color-text--yellow-600")):(this.time_offset.set_offset_friend(0),this.elmEtaArea.classList.add("mdl-color--grey-800"),this.elmEtaLabel.classList.add("mdl-color-text--grey-600"),this.elmOffset.classList.add("mdl-color-text--grey-600")),this.config.save({mode_friend:e}),this.update(!1)}},{key:"on_change_modeFrequencyUpdate",value:function(){var e=this.elmModeFrequencyUpdate.checked;this.config.save({mode_frequency_update:e}),this.update(!0)}}]),e}();window.onload=function(){new f}},"./salmonrun_time_timer.js":
/*!*********************************!*\
  !*** ./salmonrun_time_timer.js ***!
  \*********************************/
/*! exports provided: default */function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.r(t);var s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time_offset=t}return function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(e,[{key:"listup_next_STT",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),n=[];e=this.time_offset?this.time_offset.get_time(t):new Date(t);for(var i=Math.floor((e.getMinutes()-2)/8)+1,s=e.getHours();n.length<7;){for(var o=i+1;o<=7&&n.length<7;++o){var a=2+8*(o-1),r=new Date(e);r.setHours(s),r.setMinutes(a),r.setSeconds(0),r.setMilliseconds(0),n.push(r)}i=0,s+=1}return n}}]),e}();t.default=s},"./time_offset.js":
/*!************************!*\
  !*** ./time_offset.js ***!
  \************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var i=n(/*! get-json-data */"../node_modules/get-json-data/index.js"),s=n.n(i);function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=["https://ntp-a1.nict.go.jp/cgi-bin/json","https://ntp-b1.nict.go.jp/cgi-bin/json","https://ntp-a4.nict.go.jp/cgi-bin/json"],r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.offset_jst=0,this.set_offset_friend(t),this.get_offset_jst()}return function(e,t,n){t&&o(e.prototype,t),n&&o(e,n)}(e,[{key:"get_time",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=0;return this.offset_jst&&(t+=this.offset_jst),this.offset_friend&&(t+=this.offset_friend),new Date(e+t)}},{key:"set_offset_friend",value:function(e){this.offset_friend=e}},{key:"get_offset_jst",value:function(){var e=this;this.results=new Array;var t=Math.floor(3*Math.random()),n=a[t];s()(n+"?"+(new Date).getTime()/1e3,function(t,n){if(!t){var i=new Date;n.st&&n.it&&n.leap&&n.next&&n.step&&(n.rt=i.getTime(),n.it=1e3*Number(n.it),n.st=1e3*Number(n.st),n.lb=n.it-16-n.st,n.ub=n.rt+16-n.st,e.offset_jst=-(n.lb+n.ub)/2)}})}}]),e}();t.default=r}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy9nZXQtanNvbi1kYXRhL2luZGV4LmpzIiwid2VicGFjazovLy8uL2NvbmZpZy5qcyIsIndlYnBhY2s6Ly8vLi9kYXRlX2Zvcm1hdHRlci5qcyIsIndlYnBhY2s6Ly8vLi9tYWluLmpzIiwid2VicGFjazovLy8uL3NhbG1vbnJ1bl90aW1lX3RpbWVyLmpzIiwid2VicGFjazovLy8uL3RpbWVfb2Zmc2V0LmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsInZhbHVlIiwibiIsIl9fZXNNb2R1bGUiLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJtYWtlUmVxdWVzdCIsInVybCIsImNhbGxiYWNrIiwib3B0IiwieGhyIiwiWE1MSHR0cFJlcXVlc3QiLCJBY3RpdmVYT2JqZWN0IiwiZSIsInRoaXMiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCJyZWFkeVN0YXRlIiwic3RhdHVzIiwiZGF0YSIsInJlc3BvbnNlVGV4dCIsInJhdyIsIkpTT04iLCJwYXJzZSIsIkVycm9yIiwibWV0aG9kIiwicGFyYW1zIiwia2V5IiwicHVzaCIsImVuY29kZVVSSUNvbXBvbmVudCIsImxlbmd0aCIsImpvaW4iLCJvcGVuIiwic2VuZCIsInN0cmluZ2lmeSIsIndpbmRvdyIsImdldEpTT05EYXRhIiwiQ29uZmlnIiwibGlzdGVuZXIiLCJzY2hlbWUiLCJfY2xhc3NDYWxsQ2hlY2siLCJfdGhpcyIsImtleXMiLCJmb3JFYWNoIiwiaW5mbyIsInR5cGUiLCJsb2NhbFN0b3JhZ2UiLCJ1bmRlZmluZWQiLCJCb29sZWFuIiwiTnVtYmVyIiwiU3RyaW5nIiwiX3RoaXMyIiwicGFydGlhbCIsImFyZ3VtZW50cyIsIkRhdGVGb3JtYXR0ZXIiLCJNTSIsImdldE1vbnRoIiwiREQiLCJnZXREYXRlIiwiaGgiLCJnZXRIb3VycyIsIm1tIiwiZ2V0TWludXRlcyIsInNzIiwiZ2V0U2Vjb25kcyIsIlNTUyIsImdldE1pbGxpc2Vjb25kcyIsImRhdGVfZm9ybWF0dGVyIiwiQXBwIiwidGltZV9vZmZzZXQiLCJUaW1lT2Zmc2V0IiwidGltZXIiLCJTYWxtb25ydW5UaW1lVGltZXIiLCJjb25maWciLCJvbl9sb2FkIiwiYmluZCIsIm1vZGVfZnJpZW5kIiwiZGVmYXVsdCIsIm1vZGVfZnJlcXVlbmN5X3VwZGF0ZSIsImVsbUV0YSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJlbG1FdGFBcmVhIiwiZWxtRXRhTGFiZWwiLCJlbG1PZmZzZXQiLCJlbG1Nb2RlRnJpZW5kIiwib25jbGljayIsIm9uX2NoYW5nZV9tb2RlRnJpZW5kIiwiZWxtTW9kZUZyZXF1ZW5jeVVwZGF0ZSIsIm9uX2NoYW5nZV9tb2RlRnJlcXVlbmN5VXBkYXRlIiwibG9hZCIsInVwZGF0ZSIsImxpc3QiLCJsaXN0dXBfbmV4dF9TVFQiLCJub3ciLCJnZXRfdGltZSIsImV0YSIsIkRhdGUiLCJ0ZXh0RXRhIiwiZ2V0TWluVGV4dCIsImlubmVySFRNTCIsImxhYmVsVGV4dCIsIm9mZnNldF9mcmllbmQiLCJvZmZzZXRfanN0IiwidGV4dE9mZnNldCIsImVsbVNUVCIsInRleHRTVFQiLCJnZXRNb250aFRleHQiLCJsb29wIiwiY2FsY19ldGEiLCJ1cGRhdGVfZXRhIiwidXBkYXRlX2xpc3QiLCJtb2RlRnJlcXVlbmN5VXBkYXRlIiwidGltZW91dCIsImNsZWFyVGltZW91dCIsImludGVydmFsIiwic2V0VGltZW91dCIsImNoZWNrZWQiLCJtb2RlRnJpZW5kIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwic2V0X29mZnNldF9mcmllbmQiLCJhZGQiLCJzYXZlIiwib25sb2FkIiwiYmFzZSIsImRhdGUiLCJwZXJpb2QiLCJNYXRoIiwiZmxvb3IiLCJob3VycyIsIm1pbnV0ZXMiLCJzZXRIb3VycyIsInNldE1pbnV0ZXMiLCJzZXRTZWNvbmRzIiwic2V0TWlsbGlzZWNvbmRzIiwiU2VydmVyTGlzdCIsImdldF9vZmZzZXRfanN0Iiwib2Zmc2V0IiwicmVzdWx0cyIsIkFycmF5Iiwic2VydmVyX25vIiwicmFuZG9tIiwic2VydmVyX2FkZHIiLCJnZXRKU09OIiwiZ2V0VGltZSIsImVyciIsImpzb24iLCJzdCIsIml0IiwibGVhcCIsIm5leHQiLCJzdGVwIiwicnQiLCJsYiIsInViIl0sIm1hcHBpbmdzIjoiYUFDQSxJQUFBQSxLQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBQyxRQUdBLElBQUFDLEVBQUFKLEVBQUFFLElBQ0FHLEVBQUFILEVBQ0FJLEdBQUEsRUFDQUgsWUFVQSxPQU5BSSxFQUFBTCxHQUFBTSxLQUFBSixFQUFBRCxRQUFBQyxJQUFBRCxRQUFBRixHQUdBRyxFQUFBRSxHQUFBLEVBR0FGLEVBQUFELFFBS0FGLEVBQUFRLEVBQUFGLEVBR0FOLEVBQUFTLEVBQUFWLEVBR0FDLEVBQUFVLEVBQUEsU0FBQVIsRUFBQVMsRUFBQUMsR0FDQVosRUFBQWEsRUFBQVgsRUFBQVMsSUFDQUcsT0FBQUMsZUFBQWIsRUFBQVMsR0FDQUssY0FBQSxFQUNBQyxZQUFBLEVBQ0FDLElBQUFOLEtBTUFaLEVBQUFtQixFQUFBLFNBQUFqQixHQUNBWSxPQUFBQyxlQUFBYixFQUFBLGNBQWlEa0IsT0FBQSxLQUlqRHBCLEVBQUFxQixFQUFBLFNBQUFsQixHQUNBLElBQUFTLEVBQUFULEtBQUFtQixXQUNBLFdBQTJCLE9BQUFuQixFQUFBLFNBQzNCLFdBQWlDLE9BQUFBLEdBRWpDLE9BREFILEVBQUFVLEVBQUFFLEVBQUEsSUFB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VUFDZEUsRUFBS0UsR0FBdUIsSUFBbEJwRyxPQUFPa0csRUFBS0UsSUFDdEJGLEVBQUtDLEdBQXVCLElBQWxCbkcsT0FBT2tHLEVBQUtDLElBQ3RCRCxFQUFLTyxHQUFLUCxFQUFLRSxHQUFLLEdBQUtGLEVBQUtDLEdBQzlCRCxFQUFLUSxHQUFLUixFQUFLTSxHQUFLLEdBQUtOLEVBQUtDLEdBRzlCM0csRUFBSzhELGFBQWlCNEMsRUFBS08sR0FBS1AsRUFBS1EsSUFBTyxlQU83Q3JGIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gXCIuL21haW4uanNcIik7XG4iLCIvLyBnZXQtanNvbi1kYXRhXG4vL2NvZGUgZnJvbSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL0FKQVgvR2V0dGluZ19TdGFydGVkXG4oZnVuY3Rpb24oKSB7XG4gIHZhciBtYWtlUmVxdWVzdCA9IGZ1bmN0aW9uKHVybCxjYWxsYmFjayxvcHQpIHtcbiAgICB2YXIgeGhyO1xuICAgIGlmIChYTUxIdHRwUmVxdWVzdCkgeyAvLyBNb3ppbGxhLCBTYWZhcmksIC4uLlxuICAgICAgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgfSBlbHNlIGlmIChBY3RpdmVYT2JqZWN0KSB7IC8vIElFXG4gICAgICB0cnkge1xuICAgICAgICB4aHIgPSBuZXcgQWN0aXZlWE9iamVjdChcIk1zeG1sMi5YTUxIVFRQXCIpO1xuICAgICAgfSBcbiAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgeGhyID0gbmV3IEFjdGl2ZVhPYmplY3QoXCJNaWNyb3NvZnQuWE1MSFRUUFwiKTtcbiAgICAgICAgfSBcbiAgICAgICAgY2F0Y2ggKGUpIHt9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCF4aHIpIHtcbiAgICAgIGNhbGxiYWNrLmNhbGwodGhpcyxcbiAgICAgICAgJ0dpdmluZyB1cCA6KCBDYW5ub3QgY3JlYXRlIGFuIFhNTEhUVFAgaW5zdGFuY2UnLFxuICAgICAgICBudWxsKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHhoci5yZWFkeVN0YXRlID09PSA0KSB7XG4gICAgICAgIGlmICh4aHIuc3RhdHVzID49IDIwMCAmJiB4aHIuc3RhdHVzIDw0MDApIHtcbiAgICAgICAgICB2YXIgZGF0YSA9IHhoci5yZXNwb25zZVRleHQsXG4gICAgICAgICAgICByYXcgPSBvcHQgJiYgb3B0Lmhhc093blByb3BlcnR5KCdyYXcnKSA/IG9wdC5yYXcgOiBmYWxzZTsgIFxuICAgICAgICAgIGlmKCFyYXcpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGRhdGEgPSBKU09OLnBhcnNlKGRhdGEpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICBjYWxsYmFjay5jYWxsKHRoaXMsIGUsbnVsbCk7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgY2FsbGJhY2suY2FsbCh0aGlzLG51bGwsZGF0YSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY2FsbGJhY2suY2FsbCh0aGlzLFxuICAgICAgICAgICAgbmV3IEVycm9yKCdUaGVyZSB3YXMgYSBwcm9ibGVtIHdpdGggdGhlIHJlcXVlc3QnKSxcbiAgICAgICAgICAgIG51bGwpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgICB2YXIgbWV0aG9kID0gb3B0ICYmIG9wdC5tZXRob2QgPyBvcHQubWV0aG9kIDogJ0dFVCc7XG4gICAgaWYgKG1ldGhvZCA9PSAnR0VUJykgeyBcbiAgICAgIHZhciBwYXJhbXMgPSBbXTtcbiAgICAgIGlmIChvcHQgJiYgb3B0LnBhcmFtcyAmJiB0eXBlb2Yob3B0LnBhcmFtcykgPT0gJ29iamVjdCcpIHtcbiAgICAgICAgZm9yKCB2YXIga2V5IGluIG9wdC5wYXJhbXMpIHtcbiAgICAgICAgICBwYXJhbXMucHVzaChrZXkgKyc9JysgZW5jb2RlVVJJQ29tcG9uZW50KG9wdC5wYXJhbXNba2V5XSkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB1cmwgPSBwYXJhbXMubGVuZ3RoID4gMCA/IHVybCsnPycrcGFyYW1zLmpvaW4oJyYnKSA6IHVybDtcbiAgICAgIHhoci5vcGVuKCdHRVQnLCB1cmwpO1xuICAgICAgeGhyLnNlbmQoKTtcbiAgICB9IGVsc2UgaWYgKG1ldGhvZCA9PSAnUE9TVCcpIHtcbiAgICAgIHZhciBkYXRhID0gb3B0ICYmIG9wdC5kYXRhID8gb3B0LmRhdGEgOiBvcHQucGFyYW1zID8gb3B0LnBhcmFtcyA6IHt9O1xuICAgICAgeGhyLm9wZW4oJ1BPU1QnLCB1cmwpO1xuICAgICAgeGhyLnNlbmQoSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICAgIH1cbiAgICByZXR1cm4geGhyO1xuICB9XG5cbiAgaWYodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IG1ha2VSZXF1ZXN0O1xuICB9XG4gIGlmKHR5cGVvZiB3aW5kb3chPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICB3aW5kb3cuZ2V0SlNPTkRhdGEgPSBtYWtlUmVxdWVzdDtcbiAgfSBcbn0pKCk7XG4iLCJcclxuXHJcbmNsYXNzIENvbmZpZyB7XHJcbiAgICBjb25zdHJ1Y3RvcihsaXN0ZW5lciwgc2NoZW1lKSB7XHJcbiAgICAgICAgdGhpcy5saXN0ZW5lciA9IGxpc3RlbmVyO1xyXG4gICAgICAgIHRoaXMuc2NoZW1lID0gc2NoZW1lO1xyXG4gICAgfVxyXG4gICAgbG9hZCgpIHtcclxuICAgICAgICBjb25zdCBzY2hlbWUgPSB0aGlzLnNjaGVtZTtcclxuICAgICAgICBPYmplY3Qua2V5cyh0aGlzLnNjaGVtZSkuZm9yRWFjaChrZXkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpbmZvID0gdGhpcy5zY2hlbWVba2V5XTtcclxuICAgICAgICAgICAgY29uc3QgdHlwZSA9IGluZm9bXCJ0eXBlXCJdO1xyXG5cclxuICAgICAgICAgICAgdmFyIHZhbHVlID0gbG9jYWxTdG9yYWdlW2tleV07XHJcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IGluZm9bXCJkZWZhdWx0XCJdO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gQm9vbGVhbikge1xyXG4gICAgICAgICAgICAgICAgdGhpc1trZXldID0gKHZhbHVlID09ICd0cnVlJyB8fCB2YWx1ZSA9PSB0cnVlKSA/IHRydWUgOiBmYWxzZTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSBOdW1iZXIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXNba2V5XSA9IE51bWJlcih2YWx1ZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gU3RyaW5nKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzW2tleV0gPSBTdHJpbmcodmFsdWUpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpc1trZXldID0gdmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCB0aGlzKTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAodGhpcy5saXN0ZW5lcikge1xyXG4gICAgICAgICAgICB0aGlzLmxpc3RlbmVyKHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHNhdmUocGFydGlhbD11bmRlZmluZWQpIHtcclxuICAgICAgICBpZiAocGFydGlhbCkge1xyXG4gICAgICAgICAgICBPYmplY3Qua2V5cyhwYXJ0aWFsKS5mb3JFYWNoKGtleSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Vba2V5XSA9IHBhcnRpYWxba2V5XTtcclxuICAgICAgICAgICAgICAgIHRoaXNba2V5XSA9IHBhcnRpYWxba2V5XTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgT2JqZWN0LmtleXModGhpcy5zY2hlbWUpLmZvckVhY2goa2V5ID0+IHtcclxuICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZVtrZXldID0gdGhpc1trZXldO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IENvbmZpZzsiLCJjbGFzcyBEYXRlRm9ybWF0dGVyIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICB9XG5cbiAgICBnZXRNb250aFRleHQoZClcbiAgICB7XG4gICAgICAgIHZhciBNTSA9IGQuZ2V0TW9udGgoKSArIDE7XG4gICAgICAgIHZhciBERCA9IGQuZ2V0RGF0ZSgpO1xuICAgICAgICBpZiAoTU0gPCAxMCkgTU0gPSBcIjBcIiArIE1NO1xuICAgICAgICBpZiAoREQgPCAxMCkgREQgPSBcIjBcIiArIEREO1xuXG4gICAgICAgIHZhciBoaCA9IGQuZ2V0SG91cnMoKTtcbiAgICAgICAgdmFyIG1tID0gZC5nZXRNaW51dGVzKCk7XG4gICAgICAgIHZhciBzcyA9IGQuZ2V0U2Vjb25kcygpO1xuXG4gICAgICAgIGlmIChoaCA8IDEwKSBoaCA9IFwiMFwiICsgaGg7XG4gICAgICAgIGlmIChtbSA8IDEwKSBtbSA9IFwiMFwiICsgbW07XG4gICAgICAgIGlmIChzcyA8IDEwKSBzcyA9IFwiMFwiICsgc3M7XG5cbiAgICAgICAgcmV0dXJuICggTU0gKyBcIi9cIiArIEREICsgXCIgXCIgKyBoaCArIFwiOlwiICsgbW0gKyBcIjpcIiArIHNzKTtcbiAgICB9XG4gICAgZ2V0TWluVGV4dChkKVxuICAgIHtcbiAgICAgICAgdmFyIG1tID0gZC5nZXRNaW51dGVzKCk7XG4gICAgICAgIHZhciBzcyA9IGQuZ2V0U2Vjb25kcygpO1xuICAgICAgICB2YXIgU1NTID0gZC5nZXRNaWxsaXNlY29uZHMoKTtcblxuICAgICAgICBpZiAobW0gPCAxMCkgbW0gPSBcIjBcIiArIG1tO1xuICAgICAgICBpZiAoc3MgPCAxMCkgc3MgPSBcIjBcIiArIHNzO1xuICAgICAgICBpZiAgICAgIChTU1MgPCAgMTApIHsgU1NTID0gXCIwMFwiICsgU1NTOyB9XG4gICAgICAgIGVsc2UgaWYgKFNTUyA8IDEwMCkgeyBTU1MgPSBcIjBcIiArIFNTUzsgfVxuXG4gICAgICAgIHJldHVybiAobW0gKyBcIjpcIiArIHNzICsgXCIuXCIgKyBTU1MpO1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRGF0ZUZvcm1hdHRlcjtcbiIsImltcG9ydCBTYWxtb25ydW5UaW1lVGltZXIgZnJvbSBcIi4vc2FsbW9ucnVuX3RpbWVfdGltZXJcIjtcclxuaW1wb3J0IERhdGVGb3JtYXR0ZXIgZnJvbSBcIi4vZGF0ZV9mb3JtYXR0ZXJcIjtcclxuaW1wb3J0IFRpbWVPZmZzZXQgZnJvbSBcIi4vdGltZV9vZmZzZXRcIjtcclxuaW1wb3J0IENvbmZpZyBmcm9tIFwiLi9jb25maWdcIjtcclxuXHJcbmNvbnN0IGRhdGVfZm9ybWF0dGVyID0gbmV3IERhdGVGb3JtYXR0ZXIoKTtcclxuXHJcbmNsYXNzIEFwcCB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLnRpbWVfb2Zmc2V0ID0gbmV3IFRpbWVPZmZzZXQoKTtcclxuICAgICAgICB0aGlzLnRpbWVyID0gbmV3IFNhbG1vbnJ1blRpbWVUaW1lcih0aGlzLnRpbWVfb2Zmc2V0KTtcclxuICAgICAgICB0aGlzLmNvbmZpZyA9IG5ldyBDb25maWcodGhpcy5vbl9sb2FkLmJpbmQodGhpcyksIHtcclxuICAgICAgICAgICAgXCJtb2RlX2ZyaWVuZFwiOiB7XCJ0eXBlXCI6IEJvb2xlYW4sIFwiZGVmYXVsdFwiOiBmYWxzZX0sXHJcbiAgICAgICAgICAgIFwibW9kZV9mcmVxdWVuY3lfdXBkYXRlXCI6IHtcInR5cGVcIjogQm9vbGVhbiwgXCJkZWZhdWx0XCI6IGZhbHNlfSxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5lbG1FdGEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImV0YVwiKTtcclxuICAgICAgICB0aGlzLmVsbUV0YUFyZWEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImV0YV9hcmVhXCIpO1xyXG4gICAgICAgIHRoaXMuZWxtRXRhTGFiZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImV0YV9sYWJlbFwiKTtcclxuICAgICAgICB0aGlzLmVsbU9mZnNldCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwib2Zmc2V0XCIpO1xyXG5cclxuICAgICAgICB0aGlzLmVsbU1vZGVGcmllbmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1vZGVfZnJpZW5kXCIpO1xyXG4gICAgICAgIHRoaXMuZWxtTW9kZUZyaWVuZC5vbmNsaWNrID0gdGhpcy5vbl9jaGFuZ2VfbW9kZUZyaWVuZC5iaW5kKHRoaXMpO1xyXG5cclxuICAgICAgICB0aGlzLmVsbU1vZGVGcmVxdWVuY3lVcGRhdGU9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibW9kZV9mcmVxdWVuY3lfdXBkYXRlXCIpO1xyXG4gICAgICAgIHRoaXMuZWxtTW9kZUZyZXF1ZW5jeVVwZGF0ZS5vbmNsaWNrID0gdGhpcy5vbl9jaGFuZ2VfbW9kZUZyZXF1ZW5jeVVwZGF0ZS5iaW5kKHRoaXMpO1xyXG5cclxuICAgICAgICB0aGlzLmNvbmZpZy5sb2FkKCk7XHJcbiAgICAgICAgdGhpcy51cGRhdGUodHJ1ZSk7XHJcblxyXG4gICAgfVxyXG4gICAgY2FsY19ldGEoKSB7XHJcbiAgICAgICAgdGhpcy5saXN0ID0gdGhpcy50aW1lci5saXN0dXBfbmV4dF9TVFQoKTtcclxuICAgICAgICBjb25zdCBub3cgPSB0aGlzLnRpbWVfb2Zmc2V0LmdldF90aW1lKCk7XHJcbiAgICAgICAgdmFyIGV0YSA9IHRoaXMubGlzdFswXSAtIG5vdztcclxuICAgICAgICB0aGlzLmV0YSA9IG5ldyBEYXRlKGV0YSk7XHJcbiAgICB9XHJcbiAgICB1cGRhdGVfZXRhKCkge1xyXG4gICAgICAgIC8vIGV0YVxyXG4gICAgICAgIGNvbnN0IHRleHRFdGEgPSBkYXRlX2Zvcm1hdHRlci5nZXRNaW5UZXh0KHRoaXMuZXRhKTtcclxuICAgICAgICB0aGlzLmVsbUV0YS5pbm5lckhUTUwgPSB0ZXh0RXRhO1xyXG4gICAgICAgIC8vIHNob3cgbGFiZWxcclxuXHJcbiAgICAgICAgbGV0IGxhYmVsVGV4dCA9ICdTVCc7XHJcbiAgICAgICAgaWYgKHRoaXMudGltZV9vZmZzZXQub2Zmc2V0X2ZyaWVuZCAhPSAwKSB7XHJcbiAgICAgICAgICAgIGxhYmVsVGV4dCArPSAnKOODleODrOmDqOWxiyknO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsYWJlbFRleHQgKz0gJ+OBvuOBpyc7XHJcbiAgICAgICAgdGhpcy5lbG1FdGFMYWJlbC5pbm5lckhUTUwgPSBsYWJlbFRleHQ7XHJcbiAgICAgICAgLy8gc2hvdyBvZmZzZXQgdGV4dFxyXG4gICAgICAgIGlmICh0aGlzLnRpbWVfb2Zmc2V0Lm9mZnNldF9qc3QpIHtcclxuICAgICAgICAgICAgdmFyIHRleHRPZmZzZXQgPSAn6KOc5q2jOiAnO1xyXG4gICAgICAgICAgICBpZiAodGhpcy50aW1lX29mZnNldC5vZmZzZXRfanN0IDwgMCkge1xyXG4gICAgICAgICAgICAgICAgdGV4dE9mZnNldCArPSBcIi1cIiArIGRhdGVfZm9ybWF0dGVyLmdldE1pblRleHQobmV3IERhdGUoLXRoaXMudGltZV9vZmZzZXQub2Zmc2V0X2pzdCkpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGV4dE9mZnNldCArPSBcIitcIiArIGRhdGVfZm9ybWF0dGVyLmdldE1pblRleHQobmV3IERhdGUodGhpcy50aW1lX29mZnNldC5vZmZzZXRfanN0KSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMudGltZV9vZmZzZXQub2Zmc2V0X2ZyaWVuZCAhPSAwKSB7XHJcbiAgICAgICAgICAgICAgICB0ZXh0T2Zmc2V0ICs9IFwiICgy56eS6YGF44KMKVwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuZWxtT2Zmc2V0LmlubmVySFRNTCA9IHRleHRPZmZzZXQ7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5lbG1PZmZzZXQuaW5uZXJIVE1MID0gXCLmmYLliLvlkIjjgo/jgZvkuK0gLi4uXCI7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgdXBkYXRlX2xpc3QoKSB7XHJcbiAgICAgICAgLy8gbGlzdFxyXG4gICAgICAgIGZvciAobGV0IGkgaW4gdGhpcy5saXN0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVsbVNUVCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3R0LWl0ZW0tXCIgKyAoTnVtYmVyKGkpICsgMSkpO1xyXG4gICAgICAgICAgICBjb25zdCB0ZXh0U1RUID0gZGF0ZV9mb3JtYXR0ZXIuZ2V0TW9udGhUZXh0KHRoaXMubGlzdFtpXSk7XHJcbiAgICAgICAgICAgIGVsbVNUVC5pbm5lckhUTUwgPSB0ZXh0U1RUO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHVwZGF0ZShsb29wID0gZmFsc2UpIHtcclxuICAgICAgICB0aGlzLmNhbGNfZXRhKCk7XHJcbiAgICAgICAgdGhpcy51cGRhdGVfZXRhKCk7XHJcbiAgICAgICAgdGhpcy51cGRhdGVfbGlzdCgpO1xyXG5cclxuICAgICAgICBjb25zdCBtb2RlRnJlcXVlbmN5VXBkYXRlID0gdGhpcy5jb25maWdbXCJtb2RlX2ZyZXF1ZW5jeV91cGRhdGVcIl07XHJcblxyXG4gICAgICAgIGlmIChsb29wKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnRpbWVvdXQpIHtcclxuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBpbnRlcnZhbCA9IDEwMDA7XHJcbiAgICAgICAgICAgIGlmIChtb2RlRnJlcXVlbmN5VXBkYXRlIHx8IHRoaXMuZXRhIDwgNjAgKiAxMDAwKSB7XHJcbiAgICAgICAgICAgICAgICBpbnRlcnZhbCA9IDUwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMudGltZW91dCA9IHNldFRpbWVvdXQodGhpcy51cGRhdGUuYmluZCh0aGlzLCB0cnVlKSwgaW50ZXJ2YWwpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIG9uX2xvYWQoY29uZmlnKSB7XHJcbiAgICAgICAgdGhpcy5lbG1Nb2RlRnJpZW5kLmNoZWNrZWQgPSBjb25maWdbXCJtb2RlX2ZyaWVuZFwiXTtcclxuICAgICAgICB0aGlzLmVsbU1vZGVGcmVxdWVuY3lVcGRhdGUuY2hlY2tlZCA9IGNvbmZpZ1tcIm1vZGVfZnJlcXVlbmN5X3VwZGF0ZVwiXTtcclxuICAgICAgICB0aGlzLm9uX2NoYW5nZV9tb2RlRnJpZW5kKCk7XHJcbiAgICAgICAgdGhpcy5vbl9jaGFuZ2VfbW9kZUZyZXF1ZW5jeVVwZGF0ZSgpO1xyXG5cclxuICAgIH1cclxuICAgIG9uX2NoYW5nZV9tb2RlRnJpZW5kKCkge1xyXG4gICAgICAgIGNvbnN0IGNsYXNzRm9yTm9ybmFsTW9kZUJhY2sgPSAnbWRsLWNvbG9yLS1ncmV5LTgwMCc7XHJcbiAgICAgICAgY29uc3QgY2xhc3NGb3JGcmllbmRNb2RlQmFjayA9ICdtZGwtY29sb3ItLWdyZWVuLTkwMCc7XHJcbiAgICAgICAgY29uc3QgY2xhc3NGb3JOb3JuYWxNb2RlRm9yZSA9ICdtZGwtY29sb3ItdGV4dC0tZ3JleS02MDAnO1xyXG4gICAgICAgIGNvbnN0IGNsYXNzRm9yRnJpZW5kTW9kZUZvcmUgPSAnbWRsLWNvbG9yLXRleHQtLXllbGxvdy02MDAnO1xyXG5cclxuICAgICAgICBjb25zdCBtb2RlRnJpZW5kID0gdGhpcy5lbG1Nb2RlRnJpZW5kLmNoZWNrZWQ7XHJcbiAgICAgICAgdGhpcy5lbG1FdGFBcmVhLmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NGb3JOb3JuYWxNb2RlQmFjayk7XHJcbiAgICAgICAgdGhpcy5lbG1FdGFBcmVhLmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NGb3JGcmllbmRNb2RlQmFjayk7XHJcblxyXG4gICAgICAgIHRoaXMuZWxtRXRhTGFiZWwuY2xhc3NMaXN0LnJlbW92ZShjbGFzc0Zvck5vcm5hbE1vZGVGb3JlKTtcclxuICAgICAgICB0aGlzLmVsbUV0YUxhYmVsLmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NGb3JGcmllbmRNb2RlRm9yZSk7XHJcbiAgICAgICAgdGhpcy5lbG1PZmZzZXQuY2xhc3NMaXN0LnJlbW92ZShjbGFzc0Zvck5vcm5hbE1vZGVGb3JlKTtcclxuICAgICAgICB0aGlzLmVsbU9mZnNldC5jbGFzc0xpc3QucmVtb3ZlKGNsYXNzRm9yRnJpZW5kTW9kZUZvcmUpO1xyXG4gICAgICAgIGlmIChtb2RlRnJpZW5kKSB7XHJcbiAgICAgICAgICAgIHRoaXMudGltZV9vZmZzZXQuc2V0X29mZnNldF9mcmllbmQoLTIgKiAxMDAwKTtcclxuICAgICAgICAgICAgdGhpcy5lbG1FdGFBcmVhLmNsYXNzTGlzdC5hZGQoY2xhc3NGb3JGcmllbmRNb2RlQmFjayk7XHJcbiAgICAgICAgICAgIHRoaXMuZWxtRXRhTGFiZWwuY2xhc3NMaXN0LmFkZChjbGFzc0ZvckZyaWVuZE1vZGVGb3JlKTtcclxuICAgICAgICAgICAgdGhpcy5lbG1PZmZzZXQuY2xhc3NMaXN0LmFkZChjbGFzc0ZvckZyaWVuZE1vZGVGb3JlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy50aW1lX29mZnNldC5zZXRfb2Zmc2V0X2ZyaWVuZCgwKTtcclxuICAgICAgICAgICAgdGhpcy5lbG1FdGFBcmVhLmNsYXNzTGlzdC5hZGQoY2xhc3NGb3JOb3JuYWxNb2RlQmFjayk7XHJcbiAgICAgICAgICAgIHRoaXMuZWxtRXRhTGFiZWwuY2xhc3NMaXN0LmFkZChjbGFzc0Zvck5vcm5hbE1vZGVGb3JlKTtcclxuICAgICAgICAgICAgdGhpcy5lbG1PZmZzZXQuY2xhc3NMaXN0LmFkZChjbGFzc0Zvck5vcm5hbE1vZGVGb3JlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5jb25maWcuc2F2ZSh7XCJtb2RlX2ZyaWVuZFwiOiBtb2RlRnJpZW5kfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy51cGRhdGUoZmFsc2UpO1xyXG4gICAgfVxyXG4gICAgb25fY2hhbmdlX21vZGVGcmVxdWVuY3lVcGRhdGUoKSB7XHJcbiAgICAgICAgY29uc3QgbW9kZUZyZXF1ZW5jeVVwZGF0ZSA9IHRoaXMuZWxtTW9kZUZyZXF1ZW5jeVVwZGF0ZS5jaGVja2VkO1xyXG4gICAgICAgIHRoaXMuY29uZmlnLnNhdmUoe1wibW9kZV9mcmVxdWVuY3lfdXBkYXRlXCI6IG1vZGVGcmVxdWVuY3lVcGRhdGV9KTtcclxuICAgICAgICB0aGlzLnVwZGF0ZSh0cnVlKTtcclxuICAgIH1cclxufVxyXG5cclxud2luZG93Lm9ubG9hZCA9ICgpID0+IHtcclxuICAgIHZhciBhcHAgPSBuZXcgQXBwKCk7XHJcbn07IiwiY2xhc3MgU2FsbW9ucnVuVGltZVRpbWVyIHtcbiAgICBjb25zdHJ1Y3Rvcih0aW1lX29mZnNldCA9IG51bGwpIHtcbiAgICAgICAgdGhpcy50aW1lX29mZnNldCA9IHRpbWVfb2Zmc2V0O1xuICAgIH1cblxuICAgIC8vIOODhuOCueODiOOBl+OChOOBmeOBhOOCiOOBhuOBq+Wfuua6luOBruaXpeaZguOCkua4oeOBm+OCi+OCiOOBhuOBq+OBl+OBn1xuICAgIGxpc3R1cF9uZXh0X1NUVChkYXRlID0gRGF0ZS5ub3coKSkge1xuICAgICAgICB2YXIgbGlzdCA9IFtdO1xuICAgICAgICB2YXIgYmFzZTtcbiAgICAgICAgaWYgKHRoaXMudGltZV9vZmZzZXQpIHtcbiAgICAgICAgICAgIGJhc2UgPSB0aGlzLnRpbWVfb2Zmc2V0LmdldF90aW1lKGRhdGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYmFzZSA9IG5ldyBEYXRlKGRhdGUpO1xuICAgICAgICB9XG4gICAgICAgIC8vICBwZXJpb2QgfCAgIDAgICB8ICAgICAgICAgICAgMSAgICAgICAgICAgIHwgMiAgLi4uICA2IHwgICAgICAgICAgICA3ICAgICAgICAgICAgfCA4XG4gICAgICAgIC8vIG1pbnV0ZXMgfCAwMCAwMSB8IDAyIDAzIDA0IDA1IDA2IDA3IDA4IDA5IHwgMTAgLi4uIDQ5IHwgNTAgNTEgNTIgNTMgNTQgNTUgNTYgNTcgfCA1OCA1OVxuICAgICAgICB2YXIgcGVyaW9kID0gTWF0aC5mbG9vciggKGJhc2UuZ2V0TWludXRlcygpIC0gMikgLyA4KSArIDE7IC8vIGl0IGJlY29tZXMgMCB0byA4XG4gICAgICAgIFxuICAgICAgICAvLyBpbiB0aGlzIGhvdXIgKHVwdG8gMXN0KDowMiksMm5kKDoxMCksIC4uLiAsN3RoKDo1MCkpXG4gICAgICAgIHZhciBob3VycyA9IGJhc2UuZ2V0SG91cnMoKTtcblxuICAgICAgICAvLyBpdGVyYXRlIGFib3V0IGhvdXJzXG4gICAgICAgIGZvcig7IGxpc3QubGVuZ3RoIDwgNzsgKSB7XG4gICAgICAgICAgICAvLyBpbiB0aGlzIGhvdXJcbiAgICAgICAgICAgIC8vIGkg44GMIDgg44Gq44KJ5qyh44Gu5pmC6ZaT44G444CB44KC44GX44GP44GvIDcg5Lu25Z+L44G+44KM44Gw57WC5LqGXG4gICAgICAgICAgICBmb3IodmFyIGkgPSBwZXJpb2QrMTsgaSA8PSA3ICYmIGxpc3QubGVuZ3RoIDwgNzsgKytpKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1pbnV0ZXMgPSAyICsgKGktMSkgKiA4O1xuICAgICAgICAgICAgICAgIHZhciBkID0gbmV3IERhdGUoYmFzZSk7XG4gICAgICAgICAgICAgICAgZC5zZXRIb3Vycyhob3Vycyk7XG4gICAgICAgICAgICAgICAgZC5zZXRNaW51dGVzKG1pbnV0ZXMpO1xuICAgICAgICAgICAgICAgIGQuc2V0U2Vjb25kcygwKTtcbiAgICAgICAgICAgICAgICBkLnNldE1pbGxpc2Vjb25kcygwKTtcbiAgICAgICAgICAgICAgICBsaXN0LnB1c2goIGQgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGZvciBuZXh0IGhvdXJcbiAgICAgICAgICAgIHBlcmlvZCA9IDA7XG4gICAgICAgICAgICBob3VycyArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsaXN0O1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgU2FsbW9ucnVuVGltZVRpbWVyOyIsIi8vIGJhc2VkIG9uIGh0dHBzOi8vd3d3Lm5pY3QuZ28uanAvSlNUL0pTVDUuanNcblxudmFyIFNlcnZlckxpc3QgPSBbXG4gICAgXCJodHRwczovL250cC1hMS5uaWN0LmdvLmpwL2NnaS1iaW4vanNvblwiLFxuICAgIFwiaHR0cHM6Ly9udHAtYjEubmljdC5nby5qcC9jZ2ktYmluL2pzb25cIixcbiAgICBcImh0dHBzOi8vbnRwLWE0Lm5pY3QuZ28uanAvY2dpLWJpbi9qc29uXCJcbl07XG5pbXBvcnQgZ2V0SlNPTiBmcm9tIFwiZ2V0LWpzb24tZGF0YVwiO1xuXG5jbGFzcyBUaW1lT2Zmc2V0IHtcbiAgICBjb25zdHJ1Y3RvcihvZmZzZXRfZnJpZW5kID0gMCkge1xuICAgICAgICB0aGlzLm9mZnNldF9qc3QgPSAwO1xuICAgICAgICB0aGlzLnNldF9vZmZzZXRfZnJpZW5kKG9mZnNldF9mcmllbmQpO1xuICAgICAgICB0aGlzLmdldF9vZmZzZXRfanN0KCk7XG4gICAgfVxuXG4gICAgZ2V0X3RpbWUoZGF0ZSA9IERhdGUubm93KCkpIHtcbiAgICAgICAgdmFyIG9mZnNldCA9IDA7XG4gICAgICAgIGlmICh0aGlzLm9mZnNldF9qc3QpIHsgb2Zmc2V0ICs9IHRoaXMub2Zmc2V0X2pzdDsgfVxuICAgICAgICBpZiAodGhpcy5vZmZzZXRfZnJpZW5kICkgeyBvZmZzZXQgKz0gdGhpcy5vZmZzZXRfZnJpZW5kIDsgfVxuICAgICAgICByZXR1cm4gbmV3IERhdGUoZGF0ZSArIG9mZnNldCk7XG4gICAgfVxuICAgIFxuICAgIHNldF9vZmZzZXRfZnJpZW5kKG9mZnNldF9mcmllbmQpIHtcbiAgICAgICAgdGhpcy5vZmZzZXRfZnJpZW5kID0gb2Zmc2V0X2ZyaWVuZDtcbiAgICB9XG5cbiAgICBnZXRfb2Zmc2V0X2pzdCgpIHtcbiAgICAgICAgdGhpcy5yZXN1bHRzID0gbmV3IEFycmF5KCk7XG4gICAgICAgIGNvbnN0IHNlcnZlcl9ubyA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDMpO1xuICAgICAgICBjb25zdCBzZXJ2ZXJfYWRkciA9IFNlcnZlckxpc3Rbc2VydmVyX25vXTtcbiAgICAgICAgLy8g44Op44Oz44OA44Og44Gn5LiA44Gk44Gu44K144O844OQ44Gr44Ki44Kv44K744K544GZ44KM44Gw5Y2B5YiGXG4gICAgICAgIGdldEpTT04oc2VydmVyX2FkZHIgKyBcIj9cIiArICggKG5ldyBEYXRlKCkpLmdldFRpbWUoKSAvIDEwMDAgKSwgKGVyciwganNvbikgPT4ge1xuICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coU3RyaW5nKGVycikpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpO1x0IFx0XHQvLyBSZWNlaXZlIHRpbWVcbiAgICAgICAgICAgIGlmKCBqc29uLnN0ICYmIGpzb24uaXQgJiYganNvbi5sZWFwICYmIGpzb24ubmV4dCAmJiBqc29uLnN0ZXAgKSB7XG4gICAgICAgICAgICAgICAganNvbi5ydCA9IG5vdy5nZXRUaW1lKCk7IFx0XHQvLyBSZWNlaXZlIHRpbWVcbiAgICAgICAgICAgICAgICBqc29uLml0ID0gTnVtYmVyKGpzb24uaXQpICogMTAwMDsgXHQvLyBJbml0aWF0ZSB0aW1lXG4gICAgICAgICAgICAgICAganNvbi5zdCA9IE51bWJlcihqc29uLnN0KSAqIDEwMDA7IFx0Ly8gU2VuZCB0aW1lXG4gICAgICAgICAgICAgICAganNvbi5sYiA9IGpzb24uaXQgLSAxNiAtIGpzb24uc3Q7XHQvLyBlc3RpbWF0ZWQgbG93ZXIgYm91bmRcbiAgICAgICAgICAgICAgICBqc29uLnViID0ganNvbi5ydCArIDE2IC0ganNvbi5zdDtcdC8vIGVzdGltYXRlZCB1cHBlciBib3VuZFxuXG4gICAgICAgICAgICAgICAgLy8g6Kmw44G+44KL44Go44GT44KN5b+F6KaB44Gq44Gu44Gv5Lit5aSu44Gu5L+u5q2j5YCk44Gg44GRXG4gICAgICAgICAgICAgICAgdGhpcy5vZmZzZXRfanN0ID0gLSAoIGpzb24ubGIgKyBqc29uLnViICkgLyAyO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59XG5cblxuZXhwb3J0IGRlZmF1bHQgVGltZU9mZnNldDsiXSwic291cmNlUm9vdCI6IiJ9