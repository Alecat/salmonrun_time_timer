!function(e){var t={};function n(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./main.js")}({"../node_modules/get-json-data/index.js":
/*!**********************************************!*\
  !*** ../node_modules/get-json-data/index.js ***!
  \**********************************************/
/*! no static exports found */function(e,t){!function(){var t=function(e,t,n){var i;if(XMLHttpRequest)i=new XMLHttpRequest;else if(ActiveXObject)try{i=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{i=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}if(!i)return t.call(this,"Giving up :( Cannot create an XMLHTTP instance",null),!1;i.onreadystatechange=function(){if(4===i.readyState)if(i.status>=200&&i.status<400){var e=i.responseText;if(!(!(!n||!n.hasOwnProperty("raw"))&&n.raw))try{e=JSON.parse(e)}catch(e){return void t.call(this,e,null)}t.call(this,null,e)}else t.call(this,new Error("There was a problem with the request"),null)};var s=n&&n.method?n.method:"GET";if("GET"==s){var o=[];if(n&&n.params&&"object"==typeof n.params)for(var a in n.params)o.push(a+"="+encodeURIComponent(n.params[a]));e=o.length>0?e+"?"+o.join("&"):e,i.open("GET",e),i.send()}else if("POST"==s){var r=n&&n.data?n.data:n.params?n.params:{};i.open("POST",e),i.send(JSON.stringify(r))}return i};void 0!==e&&e.exports&&(e.exports=t),"undefined"!=typeof window&&(window.getJSONData=t)}()},"./config.js":
/*!*******************!*\
  !*** ./config.js ***!
  \*******************/
/*! exports provided: default */function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.r(t);var s=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.listener=t,this.scheme=n}return function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(e,[{key:"load",value:function(){var e=this;this.scheme;Object.keys(this.scheme).forEach(function(t){var n=e.scheme[t],i=n.type,s=n.default,o=localStorage[t];switch(void 0!=o&&null!=o||(o=s),i){case Boolean:e[t]="true"==o||1==o;break;case Number:e[t]=Number(o);break;case String:e[t]=String(o)}}),this.listener&&this.listener(this)}},{key:"save",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;t?Object.keys(t).forEach(function(n){localStorage[n]=t[n],e[n]=t[n]}):Object.keys(this.scheme).forEach(function(t){localStorage[t]=e[t]})}}]),e}();t.default=s},"./date_formatter.js":
/*!***************************!*\
  !*** ./date_formatter.js ***!
  \***************************/
/*! exports provided: default */function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.r(t);var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(e,[{key:"getMonthText",value:function(e){var t=e.getMonth()+1,n=e.getDate();t<10&&(t="0"+t),n<10&&(n="0"+n);var i=e.getHours(),s=e.getMinutes(),o=e.getSeconds();return i<10&&(i="0"+i),s<10&&(s="0"+s),o<10&&(o="0"+o),t+"/"+n+" "+i+":"+s+":"+o}},{key:"getMinText",value:function(e){var t=e.getMinutes(),n=e.getSeconds(),i=e.getMilliseconds();return t<10&&(t="0"+t),n<10&&(n="0"+n),i<10?i="00"+i:i<100&&(i="0"+i),t+":"+n+"."+i}}]),e}();t.default=s},"./main.js":
/*!*****************!*\
  !*** ./main.js ***!
  \*****************/
/*! no exports provided */function(e,t,n){"use strict";n.r(t);var i=n(/*! ./salmonrun_time_timer */"./salmonrun_time_timer.js"),s=n(/*! ./date_formatter */"./date_formatter.js"),o=n(/*! ./time_offset */"./time_offset.js"),a=n(/*! ./config */"./config.js");function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var l=new s.default,f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time_offset=new o.default,this.timer=new i.default(this.time_offset),this.config=new a.default(this.on_load.bind(this),{mode_friend:{type:Boolean,default:!1},mode_frequency_update:{type:Boolean,default:!1}}),this.elmEta=document.getElementById("eta"),this.elmEtaArea=document.getElementById("eta_area"),this.elmEtaLabel=document.getElementById("eta_label"),this.elmOffset=document.getElementById("offset"),this.elmModeFriend=document.getElementById("mode_friend"),this.elmModeFriend.onclick=this.on_change_modeFriend.bind(this),this.elmModeFrequencyUpdate=document.getElementById("mode_frequency_update"),this.elmModeFrequencyUpdate.onclick=this.on_change_modeFrequencyUpdate.bind(this),this.config.load(),this.update(!0)}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(e,[{key:"calc_eta",value:function(){this.list=this.timer.listup_next_STT();var e=this.time_offset.get_time(),t=this.list[0]-e;this.eta=new Date(t)}},{key:"update_eta",value:function(){var e=l.getMinText(this.eta);this.elmEta.innerHTML=e;var t="ST";if(0!=this.time_offset.offset_friend&&(t+="(フレ部屋)"),t+="まで",this.elmEtaLabel.innerHTML=t,this.time_offset.offset_jst){var n="補正: ";this.time_offset.offset_jst<0?n+="-"+l.getMinText(new Date(-this.time_offset.offset_jst)):n+="+"+l.getMinText(new Date(this.time_offset.offset_jst)),0!=this.time_offset.offset_friend&&(n+=" (2秒遅れ)"),this.elmOffset.innerHTML=n}else this.elmOffset.innerHTML="時刻合わせ中 ..."}},{key:"update_list",value:function(){for(var e in this.list){var t=document.getElementById("stt-item-"+(Number(e)+1)),n=l.getMonthText(this.list[e]);t.innerHTML=n}}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.calc_eta(),this.update_eta(),this.update_list();var t=this.config.mode_frequency_update;if(e){this.timeout&&clearTimeout(this.timeout);var n=1e3;(t||this.eta<6e4)&&(n=50),this.timeout=setTimeout(this.update.bind(this,!0),n)}}},{key:"on_load",value:function(e){this.elmModeFriend.checked=e.mode_friend,this.on_change_modeFriend(),this.on_change_modeFrequencyUpdate()}},{key:"on_change_modeFriend",value:function(){var e=this.elmModeFriend.checked;this.elmEtaArea.classList.remove("mdl-color--grey-800"),this.elmEtaArea.classList.remove("mdl-color--green-900"),this.elmEtaLabel.classList.remove("mdl-color-text--grey-600"),this.elmEtaLabel.classList.remove("mdl-color-text--yellow-600"),this.elmOffset.classList.remove("mdl-color-text--grey-600"),this.elmOffset.classList.remove("mdl-color-text--yellow-600"),e?(this.time_offset.set_offset_friend(-2e3),this.elmEtaArea.classList.add("mdl-color--green-900"),this.elmEtaLabel.classList.add("mdl-color-text--yellow-600"),this.elmOffset.classList.add("mdl-color-text--yellow-600")):(this.time_offset.set_offset_friend(0),this.elmEtaArea.classList.add("mdl-color--grey-800"),this.elmEtaLabel.classList.add("mdl-color-text--grey-600"),this.elmOffset.classList.add("mdl-color-text--grey-600")),this.config.save({mode_friend:e}),this.update(!1)}},{key:"on_change_modeFrequencyUpdate",value:function(){var e=this.elmModeFrequencyUpdate.checked;this.config.save({mode_frequency_update:e}),this.update(!0)}}]),e}();window.onload=function(){new f}},"./salmonrun_time_timer.js":
/*!*********************************!*\
  !*** ./salmonrun_time_timer.js ***!
  \*********************************/
/*! exports provided: default */function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.r(t);var s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time_offset=t}return function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(e,[{key:"listup_next_STT",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),n=[];e=this.time_offset?this.time_offset.get_time(t):new Date(t);for(var i=Math.floor((e.getMinutes()-2)/8)+1,s=e.getHours();n.length<7;){for(var o=i+1;o<=7&&n.length<7;++o){var a=2+8*(o-1),r=new Date(e);r.setHours(s),r.setMinutes(a),r.setSeconds(0),r.setMilliseconds(0),n.push(r)}i=0,s+=1}return n}}]),e}();t.default=s},"./time_offset.js":
/*!************************!*\
  !*** ./time_offset.js ***!
  \************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var i=n(/*! get-json-data */"../node_modules/get-json-data/index.js"),s=n.n(i);function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=["https://ntp-a1.nict.go.jp/cgi-bin/json","https://ntp-b1.nict.go.jp/cgi-bin/json","https://ntp-a4.nict.go.jp/cgi-bin/json"],r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.offset_jst=0,this.set_offset_friend(t),this.get_offset_jst()}return function(e,t,n){t&&o(e.prototype,t),n&&o(e,n)}(e,[{key:"get_time",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=0;return this.offset_jst&&(t+=this.offset_jst),this.offset_friend&&(t+=this.offset_friend),new Date(e+t)}},{key:"set_offset_friend",value:function(e){this.offset_friend=e}},{key:"get_offset_jst",value:function(){var e=this;this.results=new Array;var t=Math.floor(3*Math.random()),n=a[t];s()(n+"?"+(new Date).getTime()/1e3,function(t,n){if(!t){var i=new Date;n.st&&n.it&&n.leap&&n.next&&n.step&&(n.rt=i.getTime(),n.it=1e3*Number(n.it),n.st=1e3*Number(n.st),n.lb=n.it-16-n.st,n.ub=n.rt+16-n.st,e.offset_jst=-(n.lb+n.ub)/2)}})}}]),e}();t.default=r}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy9nZXQtanNvbi1kYXRhL2luZGV4LmpzIiwid2VicGFjazovLy8uL2NvbmZpZy5qcyIsIndlYnBhY2s6Ly8vLi9kYXRlX2Zvcm1hdHRlci5qcyIsIndlYnBhY2s6Ly8vLi9tYWluLmpzIiwid2VicGFjazovLy8uL3NhbG1vbnJ1bl90aW1lX3RpbWVyLmpzIiwid2VicGFjazovLy8uL3RpbWVfb2Zmc2V0LmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsInZhbHVlIiwibiIsIl9fZXNNb2R1bGUiLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJtYWtlUmVxdWVzdCIsInVybCIsImNhbGxiYWNrIiwib3B0IiwieGhyIiwiWE1MSHR0cFJlcXVlc3QiLCJBY3RpdmVYT2JqZWN0IiwiZSIsInRoaXMiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCJyZWFkeVN0YXRlIiwic3RhdHVzIiwiZGF0YSIsInJlc3BvbnNlVGV4dCIsInJhdyIsIkpTT04iLCJwYXJzZSIsIkVycm9yIiwibWV0aG9kIiwicGFyYW1zIiwia2V5IiwicHVzaCIsImVuY29kZVVSSUNvbXBvbmVudCIsImxlbmd0aCIsImpvaW4iLCJvcGVuIiwic2VuZCIsInN0cmluZ2lmeSIsIndpbmRvdyIsImdldEpTT05EYXRhIiwiQ29uZmlnIiwibGlzdGVuZXIiLCJzY2hlbWUiLCJfY2xhc3NDYWxsQ2hlY2siLCJfdGhpcyIsImtleXMiLCJmb3JFYWNoIiwiaW5mbyIsInR5cGUiLCJkZWYiLCJsb2NhbFN0b3JhZ2UiLCJ1bmRlZmluZWQiLCJCb29sZWFuIiwiTnVtYmVyIiwiU3RyaW5nIiwiX3RoaXMyIiwicGFydGlhbCIsImFyZ3VtZW50cyIsIkRhdGVGb3JtYXR0ZXIiLCJNTSIsImdldE1vbnRoIiwiREQiLCJnZXREYXRlIiwiaGgiLCJnZXRIb3VycyIsIm1tIiwiZ2V0TWludXRlcyIsInNzIiwiZ2V0U2Vjb25kcyIsIlNTUyIsImdldE1pbGxpc2Vjb25kcyIsImRhdGVfZm9ybWF0dGVyIiwiQXBwIiwidGltZV9vZmZzZXQiLCJUaW1lT2Zmc2V0IiwidGltZXIiLCJTYWxtb25ydW5UaW1lVGltZXIiLCJjb25maWciLCJvbl9sb2FkIiwiYmluZCIsIm1vZGVfZnJpZW5kIiwiZGVmYXVsdCIsIm1vZGVfZnJlcXVlbmN5X3VwZGF0ZSIsImVsbUV0YSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJlbG1FdGFBcmVhIiwiZWxtRXRhTGFiZWwiLCJlbG1PZmZzZXQiLCJlbG1Nb2RlRnJpZW5kIiwib25jbGljayIsIm9uX2NoYW5nZV9tb2RlRnJpZW5kIiwiZWxtTW9kZUZyZXF1ZW5jeVVwZGF0ZSIsIm9uX2NoYW5nZV9tb2RlRnJlcXVlbmN5VXBkYXRlIiwibG9hZCIsInVwZGF0ZSIsImxpc3QiLCJsaXN0dXBfbmV4dF9TVFQiLCJub3ciLCJnZXRfdGltZSIsImV0YSIsIkRhdGUiLCJ0ZXh0RXRhIiwiZ2V0TWluVGV4dCIsImlubmVySFRNTCIsImxhYmVsVGV4dCIsIm9mZnNldF9mcmllbmQiLCJvZmZzZXRfanN0IiwidGV4dE9mZnNldCIsImVsbVNUVCIsInRleHRTVFQiLCJnZXRNb250aFRleHQiLCJsb29wIiwiY2FsY19ldGEiLCJ1cGRhdGVfZXRhIiwidXBkYXRlX2xpc3QiLCJtb2RlRnJlcXVlbmN5VXBkYXRlIiwidGltZW91dCIsImNsZWFyVGltZW91dCIsImludGVydmFsIiwic2V0VGltZW91dCIsImNoZWNrZWQiLCJtb2RlRnJpZW5kIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwic2V0X29mZnNldF9mcmllbmQiLCJhZGQiLCJzYXZlIiwib25sb2FkIiwiYmFzZSIsImRhdGUiLCJwZXJpb2QiLCJNYXRoIiwiZmxvb3IiLCJob3VycyIsIm1pbnV0ZXMiLCJzZXRIb3VycyIsInNldE1pbnV0ZXMiLCJzZXRTZWNvbmRzIiwic2V0TWlsbGlzZWNvbmRzIiwiU2VydmVyTGlzdCIsImdldF9vZmZzZXRfanN0Iiwib2Zmc2V0IiwicmVzdWx0cyIsIkFycmF5Iiwic2VydmVyX25vIiwicmFuZG9tIiwic2VydmVyX2FkZHIiLCJnZXRKU09OIiwiZ2V0VGltZSIsImVyciIsImpzb24iLCJzdCIsIml0IiwibGVhcCIsIm5leHQiLCJzdGVwIiwicnQiLCJsYiIsInViIl0sIm1hcHBpbmdzIjoiYUFDQSxJQUFBQSxLQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBQyxRQUdBLElBQUFDLEVBQUFKLEVBQUFFLElBQ0FHLEVBQUFILEVBQ0FJLEdBQUEsRUFDQUgsWUFVQSxPQU5BSSxFQUFBTCxHQUFBTSxLQUFBSixFQUFBRCxRQUFBQyxJQUFBRCxRQUFBRixHQUdBRyxFQUFBRSxHQUFBLEVBR0FGLEVBQUFELFFBS0FGLEVBQUFRLEVBQUFGLEVBR0FOLEVBQUFTLEVBQUFWLEVBR0FDLEVBQUFVLEVBQUEsU0FBQVIsRUFBQVMsRUFBQUMsR0FDQVosRUFBQWEsRUFBQVgsRUFBQVMsSUFDQUcsT0FBQUMsZUFBQWIsRUFBQVMsR0FDQUssY0FBQSxFQUNBQyxZQUFBLEVBQ0FDLElBQUFOLEtBTUFaLEVBQUFtQixFQUFBLFNBQUFqQixHQUNBWSxPQUFBQyxlQUFBYixFQUFBLGNBQWlEa0IsT0FBQSxLQUlqRHBCLEVBQUFxQixFQUFBLFNBQUFsQixHQUNBLElBQUFTLEVBQUFULEtBQUFtQixXQUNBLFdBQTJCLE9BQUFuQixFQUFBLFNBQzNCLFdBQWlDLE9BQUFBLEdBRWpDLE9BREFILEVBQUFVLEVBQUFFLEVB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QU9rRyxFQUFLRSxJQUN0QkYsRUFBS0MsR0FBdUIsSUFBbEJuRyxPQUFPa0csRUFBS0MsSUFDdEJELEVBQUtPLEdBQUtQLEVBQUtFLEdBQUssR0FBS0YsRUFBS0MsR0FDOUJELEVBQUtRLEdBQUtSLEVBQUtNLEdBQUssR0FBS04sRUFBS0MsR0FHOUI1RyxFQUFLK0QsYUFBaUI0QyxFQUFLTyxHQUFLUCxFQUFLUSxJQUFPLGVBTzdDckYiLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbiBcdFx0XHRcdGdldDogZ2V0dGVyXG4gXHRcdFx0fSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSBcIi4vbWFpbi5qc1wiKTtcbiIsIi8vIGdldC1qc29uLWRhdGFcbi8vY29kZSBmcm9tIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvQUpBWC9HZXR0aW5nX1N0YXJ0ZWRcbihmdW5jdGlvbigpIHtcbiAgdmFyIG1ha2VSZXF1ZXN0ID0gZnVuY3Rpb24odXJsLGNhbGxiYWNrLG9wdCkge1xuICAgIHZhciB4aHI7XG4gICAgaWYgKFhNTEh0dHBSZXF1ZXN0KSB7IC8vIE1vemlsbGEsIFNhZmFyaSwgLi4uXG4gICAgICB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICB9IGVsc2UgaWYgKEFjdGl2ZVhPYmplY3QpIHsgLy8gSUVcbiAgICAgIHRyeSB7XG4gICAgICAgIHhociA9IG5ldyBBY3RpdmVYT2JqZWN0KFwiTXN4bWwyLlhNTEhUVFBcIik7XG4gICAgICB9IFxuICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICB4aHIgPSBuZXcgQWN0aXZlWE9iamVjdChcIk1pY3Jvc29mdC5YTUxIVFRQXCIpO1xuICAgICAgICB9IFxuICAgICAgICBjYXRjaCAoZSkge31cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIXhocikge1xuICAgICAgY2FsbGJhY2suY2FsbCh0aGlzLFxuICAgICAgICAnR2l2aW5nIHVwIDooIENhbm5vdCBjcmVhdGUgYW4gWE1MSFRUUCBpbnN0YW5jZScsXG4gICAgICAgIG51bGwpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT09IDQpIHtcbiAgICAgICAgaWYgKHhoci5zdGF0dXMgPj0gMjAwICYmIHhoci5zdGF0dXMgPDQwMCkge1xuICAgICAgICAgIHZhciBkYXRhID0geGhyLnJlc3BvbnNlVGV4dCxcbiAgICAgICAgICAgIHJhdyA9IG9wdCAmJiBvcHQuaGFzT3duUHJvcGVydHkoJ3JhdycpID8gb3B0LnJhdyA6IGZhbHNlOyAgXG4gICAgICAgICAgaWYoIXJhdykge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgZGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgIGNhbGxiYWNrLmNhbGwodGhpcywgZSxudWxsKTtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBjYWxsYmFjay5jYWxsKHRoaXMsbnVsbCxkYXRhKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjYWxsYmFjay5jYWxsKHRoaXMsXG4gICAgICAgICAgICBuZXcgRXJyb3IoJ1RoZXJlIHdhcyBhIHByb2JsZW0gd2l0aCB0aGUgcmVxdWVzdCcpLFxuICAgICAgICAgICAgbnVsbCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICAgIHZhciBtZXRob2QgPSBvcHQgJiYgb3B0Lm1ldGhvZCA/IG9wdC5tZXRob2QgOiAnR0VUJztcbiAgICBpZiAobWV0aG9kID09ICdHRVQnKSB7IFxuICAgICAgdmFyIHBhcmFtcyA9IFtdO1xuICAgICAgaWYgKG9wdCAmJiBvcHQucGFyYW1zICYmIHR5cGVvZihvcHQucGFyYW1zKSA9PSAnb2JqZWN0Jykge1xuICAgICAgICBmb3IoIHZhciBrZXkgaW4gb3B0LnBhcmFtcykge1xuICAgICAgICAgIHBhcmFtcy5wdXNoKGtleSArJz0nKyBlbmNvZGVVUklDb21wb25lbnQob3B0LnBhcmFtc1trZXldKSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHVybCA9IHBhcmFtcy5sZW5ndGggPiAwID8gdXJsKyc/JytwYXJhbXMuam9pbignJicpIDogdXJsO1xuICAgICAgeGhyLm9wZW4oJ0dFVCcsIHVybCk7XG4gICAgICB4aHIuc2VuZCgpO1xuICAgIH0gZWxzZSBpZiAobWV0aG9kID09ICdQT1NUJykge1xuICAgICAgdmFyIGRhdGEgPSBvcHQgJiYgb3B0LmRhdGEgPyBvcHQuZGF0YSA6IG9wdC5wYXJhbXMgPyBvcHQucGFyYW1zIDoge307XG4gICAgICB4aHIub3BlbignUE9TVCcsIHVybCk7XG4gICAgICB4aHIuc2VuZChKU09OLnN0cmluZ2lmeShkYXRhKSk7XG4gICAgfVxuICAgIHJldHVybiB4aHI7XG4gIH1cblxuICBpZih0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiBtb2R1bGUuZXhwb3J0cykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gbWFrZVJlcXVlc3Q7XG4gIH1cbiAgaWYodHlwZW9mIHdpbmRvdyE9PSAndW5kZWZpbmVkJykge1xuICAgIHdpbmRvdy5nZXRKU09ORGF0YSA9IG1ha2VSZXF1ZXN0O1xuICB9IFxufSkoKTtcbiIsIlxyXG5cclxuY2xhc3MgQ29uZmlnIHtcclxuICAgIGNvbnN0cnVjdG9yKGxpc3RlbmVyLCBzY2hlbWUpIHtcclxuICAgICAgICB0aGlzLmxpc3RlbmVyID0gbGlzdGVuZXI7XHJcbiAgICAgICAgdGhpcy5zY2hlbWUgPSBzY2hlbWU7XHJcbiAgICB9XHJcbiAgICBsb2FkKCkge1xyXG4gICAgICAgIGNvbnN0IHNjaGVtZSA9IHRoaXMuc2NoZW1lO1xyXG4gICAgICAgIE9iamVjdC5rZXlzKHRoaXMuc2NoZW1lKS5mb3JFYWNoKGtleSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGluZm8gPSB0aGlzLnNjaGVtZVtrZXldO1xyXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMpXHJcbiAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBpbmZvW1widHlwZVwiXTtcclxuICAgICAgICAgICAgY29uc3QgZGVmICA9IGluZm9bXCJkZWZhdWx0XCJdO1xyXG5cclxuICAgICAgICAgICAgdmFyIHZhbHVlID0gbG9jYWxTdG9yYWdlW2tleV07XHJcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PSB1bmRlZmluZWQgfHwgdmFsdWUgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgdmFsdWUgPSBkZWY7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN3aXRjaCh0eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIEJvb2xlYW46XHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpc1trZXldID0gKHZhbHVlID09ICd0cnVlJyB8fCB2YWx1ZSA9PSB0cnVlKSA/IHRydWUgOiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhc2UgTnVtYmVyOlxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXNba2V5XSA9IE51bWJlcih2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXNlIFN0cmluZzpcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzW2tleV0gPSBTdHJpbmcodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKHRoaXMubGlzdGVuZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5saXN0ZW5lcih0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBzYXZlKHBhcnRpYWw9dW5kZWZpbmVkKSB7XHJcbiAgICAgICAgaWYgKHBhcnRpYWwpIHtcclxuICAgICAgICAgICAgT2JqZWN0LmtleXMocGFydGlhbCkuZm9yRWFjaChrZXkgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhsb2NhbFN0b3JhZ2Vba2V5XSApO1xyXG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlW2tleV0gPSBwYXJ0aWFsW2tleV07XHJcbiAgICAgICAgICAgICAgICB0aGlzW2tleV0gPSBwYXJ0aWFsW2tleV07XHJcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGtleSApO1xyXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhsb2NhbFN0b3JhZ2Vba2V5XSApO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBPYmplY3Qua2V5cyh0aGlzLnNjaGVtZSkuZm9yRWFjaChrZXkgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhsb2NhbFN0b3JhZ2Vba2V5XSApO1xyXG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlW2tleV0gPSB0aGlzW2tleV07XHJcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGtleSApO1xyXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhsb2NhbFN0b3JhZ2Vba2V5XSApO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IENvbmZpZzsiLCJjbGFzcyBEYXRlRm9ybWF0dGVyIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICB9XG5cbiAgICBnZXRNb250aFRleHQoZClcbiAgICB7XG4gICAgICAgIHZhciBNTSA9IGQuZ2V0TW9udGgoKSArIDE7XG4gICAgICAgIHZhciBERCA9IGQuZ2V0RGF0ZSgpO1xuICAgICAgICBpZiAoTU0gPCAxMCkgTU0gPSBcIjBcIiArIE1NO1xuICAgICAgICBpZiAoREQgPCAxMCkgREQgPSBcIjBcIiArIEREO1xuXG4gICAgICAgIHZhciBoaCA9IGQuZ2V0SG91cnMoKTtcbiAgICAgICAgdmFyIG1tID0gZC5nZXRNaW51dGVzKCk7XG4gICAgICAgIHZhciBzcyA9IGQuZ2V0U2Vjb25kcygpO1xuXG4gICAgICAgIGlmIChoaCA8IDEwKSBoaCA9IFwiMFwiICsgaGg7XG4gICAgICAgIGlmIChtbSA8IDEwKSBtbSA9IFwiMFwiICsgbW07XG4gICAgICAgIGlmIChzcyA8IDEwKSBzcyA9IFwiMFwiICsgc3M7XG5cbiAgICAgICAgcmV0dXJuICggTU0gKyBcIi9cIiArIEREICsgXCIgXCIgKyBoaCArIFwiOlwiICsgbW0gKyBcIjpcIiArIHNzKTtcbiAgICB9XG4gICAgZ2V0TWluVGV4dChkKVxuICAgIHtcbiAgICAgICAgdmFyIG1tID0gZC5nZXRNaW51dGVzKCk7XG4gICAgICAgIHZhciBzcyA9IGQuZ2V0U2Vjb25kcygpO1xuICAgICAgICB2YXIgU1NTID0gZC5nZXRNaWxsaXNlY29uZHMoKTtcblxuICAgICAgICBpZiAobW0gPCAxMCkgbW0gPSBcIjBcIiArIG1tO1xuICAgICAgICBpZiAoc3MgPCAxMCkgc3MgPSBcIjBcIiArIHNzO1xuICAgICAgICBpZiAgICAgIChTU1MgPCAgMTApIHsgU1NTID0gXCIwMFwiICsgU1NTOyB9XG4gICAgICAgIGVsc2UgaWYgKFNTUyA8IDEwMCkgeyBTU1MgPSBcIjBcIiArIFNTUzsgfVxuXG4gICAgICAgIHJldHVybiAobW0gKyBcIjpcIiArIHNzICsgXCIuXCIgKyBTU1MpO1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRGF0ZUZvcm1hdHRlcjtcbiIsImltcG9ydCBTYWxtb25ydW5UaW1lVGltZXIgZnJvbSBcIi4vc2FsbW9ucnVuX3RpbWVfdGltZXJcIjtcclxuaW1wb3J0IERhdGVGb3JtYXR0ZXIgZnJvbSBcIi4vZGF0ZV9mb3JtYXR0ZXJcIjtcclxuaW1wb3J0IFRpbWVPZmZzZXQgZnJvbSBcIi4vdGltZV9vZmZzZXRcIjtcclxuaW1wb3J0IENvbmZpZyBmcm9tIFwiLi9jb25maWdcIjtcclxuXHJcbmNvbnN0IGRhdGVfZm9ybWF0dGVyID0gbmV3IERhdGVGb3JtYXR0ZXIoKTtcclxuXHJcbmNsYXNzIEFwcCB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLnRpbWVfb2Zmc2V0ID0gbmV3IFRpbWVPZmZzZXQoKTtcclxuICAgICAgICB0aGlzLnRpbWVyID0gbmV3IFNhbG1vbnJ1blRpbWVUaW1lcih0aGlzLnRpbWVfb2Zmc2V0KTtcclxuICAgICAgICB0aGlzLmNvbmZpZyA9IG5ldyBDb25maWcodGhpcy5vbl9sb2FkLmJpbmQodGhpcyksIHtcclxuICAgICAgICAgICAgXCJtb2RlX2ZyaWVuZFwiOiB7XCJ0eXBlXCI6IEJvb2xlYW4sIFwiZGVmYXVsdFwiOiBmYWxzZX0sXHJcbiAgICAgICAgICAgIFwibW9kZV9mcmVxdWVuY3lfdXBkYXRlXCI6IHtcInR5cGVcIjogQm9vbGVhbiwgXCJkZWZhdWx0XCI6IGZhbHNlfSxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5lbG1FdGEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImV0YVwiKTtcclxuICAgICAgICB0aGlzLmVsbUV0YUFyZWEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImV0YV9hcmVhXCIpO1xyXG4gICAgICAgIHRoaXMuZWxtRXRhTGFiZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImV0YV9sYWJlbFwiKTtcclxuICAgICAgICB0aGlzLmVsbU9mZnNldCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwib2Zmc2V0XCIpO1xyXG5cclxuICAgICAgICB0aGlzLmVsbU1vZGVGcmllbmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1vZGVfZnJpZW5kXCIpO1xyXG4gICAgICAgIHRoaXMuZWxtTW9kZUZyaWVuZC5vbmNsaWNrID0gdGhpcy5vbl9jaGFuZ2VfbW9kZUZyaWVuZC5iaW5kKHRoaXMpO1xyXG5cclxuICAgICAgICB0aGlzLmVsbU1vZGVGcmVxdWVuY3lVcGRhdGU9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibW9kZV9mcmVxdWVuY3lfdXBkYXRlXCIpO1xyXG4gICAgICAgIHRoaXMuZWxtTW9kZUZyZXF1ZW5jeVVwZGF0ZS5vbmNsaWNrID0gdGhpcy5vbl9jaGFuZ2VfbW9kZUZyZXF1ZW5jeVVwZGF0ZS5iaW5kKHRoaXMpO1xyXG5cclxuICAgICAgICB0aGlzLmNvbmZpZy5sb2FkKCk7XHJcbiAgICAgICAgdGhpcy51cGRhdGUodHJ1ZSk7XHJcblxyXG4gICAgfVxyXG4gICAgY2FsY19ldGEoKSB7XHJcbiAgICAgICAgdGhpcy5saXN0ID0gdGhpcy50aW1lci5saXN0dXBfbmV4dF9TVFQoKTtcclxuICAgICAgICBjb25zdCBub3cgPSB0aGlzLnRpbWVfb2Zmc2V0LmdldF90aW1lKCk7XHJcbiAgICAgICAgdmFyIGV0YSA9IHRoaXMubGlzdFswXSAtIG5vdztcclxuICAgICAgICB0aGlzLmV0YSA9IG5ldyBEYXRlKGV0YSk7XHJcbiAgICB9XHJcbiAgICB1cGRhdGVfZXRhKCkge1xyXG4gICAgICAgIC8vIGV0YVxyXG4gICAgICAgIGNvbnN0IHRleHRFdGEgPSBkYXRlX2Zvcm1hdHRlci5nZXRNaW5UZXh0KHRoaXMuZXRhKTtcclxuICAgICAgICB0aGlzLmVsbUV0YS5pbm5lckhUTUwgPSB0ZXh0RXRhO1xyXG4gICAgICAgIC8vIHNob3cgbGFiZWxcclxuXHJcbiAgICAgICAgbGV0IGxhYmVsVGV4dCA9ICdTVCc7XHJcbiAgICAgICAgaWYgKHRoaXMudGltZV9vZmZzZXQub2Zmc2V0X2ZyaWVuZCAhPSAwKSB7XHJcbiAgICAgICAgICAgIGxhYmVsVGV4dCArPSAnKOODleODrOmDqOWxiyknO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsYWJlbFRleHQgKz0gJ+OBvuOBpyc7XHJcbiAgICAgICAgdGhpcy5lbG1FdGFMYWJlbC5pbm5lckhUTUwgPSBsYWJlbFRleHQ7XHJcbiAgICAgICAgLy8gc2hvdyBvZmZzZXQgdGV4dFxyXG4gICAgICAgIGlmICh0aGlzLnRpbWVfb2Zmc2V0Lm9mZnNldF9qc3QpIHtcclxuICAgICAgICAgICAgdmFyIHRleHRPZmZzZXQgPSAn6KOc5q2jOiAnO1xyXG4gICAgICAgICAgICBpZiAodGhpcy50aW1lX29mZnNldC5vZmZzZXRfanN0IDwgMCkge1xyXG4gICAgICAgICAgICAgICAgdGV4dE9mZnNldCArPSBcIi1cIiArIGRhdGVfZm9ybWF0dGVyLmdldE1pblRleHQobmV3IERhdGUoLXRoaXMudGltZV9vZmZzZXQub2Zmc2V0X2pzdCkpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGV4dE9mZnNldCArPSBcIitcIiArIGRhdGVfZm9ybWF0dGVyLmdldE1pblRleHQobmV3IERhdGUodGhpcy50aW1lX29mZnNldC5vZmZzZXRfanN0KSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMudGltZV9vZmZzZXQub2Zmc2V0X2ZyaWVuZCAhPSAwKSB7XHJcbiAgICAgICAgICAgICAgICB0ZXh0T2Zmc2V0ICs9IFwiICgy56eS6YGF44KMKVwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuZWxtT2Zmc2V0LmlubmVySFRNTCA9IHRleHRPZmZzZXQ7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5lbG1PZmZzZXQuaW5uZXJIVE1MID0gXCLmmYLliLvlkIjjgo/jgZvkuK0gLi4uXCI7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgdXBkYXRlX2xpc3QoKSB7XHJcbiAgICAgICAgLy8gbGlzdFxyXG4gICAgICAgIGZvciAobGV0IGkgaW4gdGhpcy5saXN0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVsbVNUVCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3R0LWl0ZW0tXCIgKyAoTnVtYmVyKGkpICsgMSkpO1xyXG4gICAgICAgICAgICBjb25zdCB0ZXh0U1RUID0gZGF0ZV9mb3JtYXR0ZXIuZ2V0TW9udGhUZXh0KHRoaXMubGlzdFtpXSk7XHJcbiAgICAgICAgICAgIGVsbVNUVC5pbm5lckhUTUwgPSB0ZXh0U1RUO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHVwZGF0ZShsb29wID0gZmFsc2UpIHtcclxuICAgICAgICB0aGlzLmNhbGNfZXRhKCk7XHJcbiAgICAgICAgdGhpcy51cGRhdGVfZXRhKCk7XHJcbiAgICAgICAgdGhpcy51cGRhdGVfbGlzdCgpO1xyXG5cclxuICAgICAgICBjb25zdCBtb2RlRnJlcXVlbmN5VXBkYXRlID0gdGhpcy5jb25maWdbXCJtb2RlX2ZyZXF1ZW5jeV91cGRhdGVcIl07XHJcblxyXG4gICAgICAgIGlmIChsb29wKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnRpbWVvdXQpIHtcclxuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBpbnRlcnZhbCA9IDEwMDA7XHJcbiAgICAgICAgICAgIGlmIChtb2RlRnJlcXVlbmN5VXBkYXRlIHx8IHRoaXMuZXRhIDwgNjAgKiAxMDAwKSB7XHJcbiAgICAgICAgICAgICAgICBpbnRlcnZhbCA9IDUwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMudGltZW91dCA9IHNldFRpbWVvdXQodGhpcy51cGRhdGUuYmluZCh0aGlzLCB0cnVlKSwgaW50ZXJ2YWwpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIG9uX2xvYWQoY29uZmlnKSB7XHJcbiAgICAgICAgdGhpcy5lbG1Nb2RlRnJpZW5kLmNoZWNrZWQgPSBjb25maWdbXCJtb2RlX2ZyaWVuZFwiXTtcclxuICAgICAgICB0aGlzLm9uX2NoYW5nZV9tb2RlRnJpZW5kKCk7XHJcbiAgICAgICAgdGhpcy5vbl9jaGFuZ2VfbW9kZUZyZXF1ZW5jeVVwZGF0ZSgpO1xyXG5cclxuICAgIH1cclxuICAgIG9uX2NoYW5nZV9tb2RlRnJpZW5kKCkge1xyXG4gICAgICAgIGNvbnN0IGNsYXNzRm9yTm9ybmFsTW9kZUJhY2sgPSAnbWRsLWNvbG9yLS1ncmV5LTgwMCc7XHJcbiAgICAgICAgY29uc3QgY2xhc3NGb3JGcmllbmRNb2RlQmFjayA9ICdtZGwtY29sb3ItLWdyZWVuLTkwMCc7XHJcbiAgICAgICAgY29uc3QgY2xhc3NGb3JOb3JuYWxNb2RlRm9yZSA9ICdtZGwtY29sb3ItdGV4dC0tZ3JleS02MDAnO1xyXG4gICAgICAgIGNvbnN0IGNsYXNzRm9yRnJpZW5kTW9kZUZvcmUgPSAnbWRsLWNvbG9yLXRleHQtLXllbGxvdy02MDAnO1xyXG5cclxuICAgICAgICBjb25zdCBtb2RlRnJpZW5kID0gdGhpcy5lbG1Nb2RlRnJpZW5kLmNoZWNrZWQ7XHJcbiAgICAgICAgdGhpcy5lbG1FdGFBcmVhLmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NGb3JOb3JuYWxNb2RlQmFjayk7XHJcbiAgICAgICAgdGhpcy5lbG1FdGFBcmVhLmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NGb3JGcmllbmRNb2RlQmFjayk7XHJcblxyXG4gICAgICAgIHRoaXMuZWxtRXRhTGFiZWwuY2xhc3NMaXN0LnJlbW92ZShjbGFzc0Zvck5vcm5hbE1vZGVGb3JlKTtcclxuICAgICAgICB0aGlzLmVsbUV0YUxhYmVsLmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NGb3JGcmllbmRNb2RlRm9yZSk7XHJcbiAgICAgICAgdGhpcy5lbG1PZmZzZXQuY2xhc3NMaXN0LnJlbW92ZShjbGFzc0Zvck5vcm5hbE1vZGVGb3JlKTtcclxuICAgICAgICB0aGlzLmVsbU9mZnNldC5jbGFzc0xpc3QucmVtb3ZlKGNsYXNzRm9yRnJpZW5kTW9kZUZvcmUpO1xyXG4gICAgICAgIGlmIChtb2RlRnJpZW5kKSB7XHJcbiAgICAgICAgICAgIHRoaXMudGltZV9vZmZzZXQuc2V0X29mZnNldF9mcmllbmQoLTIgKiAxMDAwKTtcclxuICAgICAgICAgICAgdGhpcy5lbG1FdGFBcmVhLmNsYXNzTGlzdC5hZGQoY2xhc3NGb3JGcmllbmRNb2RlQmFjayk7XHJcbiAgICAgICAgICAgIHRoaXMuZWxtRXRhTGFiZWwuY2xhc3NMaXN0LmFkZChjbGFzc0ZvckZyaWVuZE1vZGVGb3JlKTtcclxuICAgICAgICAgICAgdGhpcy5lbG1PZmZzZXQuY2xhc3NMaXN0LmFkZChjbGFzc0ZvckZyaWVuZE1vZGVGb3JlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy50aW1lX29mZnNldC5zZXRfb2Zmc2V0X2ZyaWVuZCgwKTtcclxuICAgICAgICAgICAgdGhpcy5lbG1FdGFBcmVhLmNsYXNzTGlzdC5hZGQoY2xhc3NGb3JOb3JuYWxNb2RlQmFjayk7XHJcbiAgICAgICAgICAgIHRoaXMuZWxtRXRhTGFiZWwuY2xhc3NMaXN0LmFkZChjbGFzc0Zvck5vcm5hbE1vZGVGb3JlKTtcclxuICAgICAgICAgICAgdGhpcy5lbG1PZmZzZXQuY2xhc3NMaXN0LmFkZChjbGFzc0Zvck5vcm5hbE1vZGVGb3JlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5jb25maWcuc2F2ZSh7XCJtb2RlX2ZyaWVuZFwiOiBtb2RlRnJpZW5kfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy51cGRhdGUoZmFsc2UpO1xyXG4gICAgfVxyXG4gICAgb25fY2hhbmdlX21vZGVGcmVxdWVuY3lVcGRhdGUoKSB7XHJcbiAgICAgICAgY29uc3QgbW9kZUZyZXF1ZW5jeVVwZGF0ZSA9IHRoaXMuZWxtTW9kZUZyZXF1ZW5jeVVwZGF0ZS5jaGVja2VkO1xyXG4gICAgICAgIHRoaXMuY29uZmlnLnNhdmUoe1wibW9kZV9mcmVxdWVuY3lfdXBkYXRlXCI6IG1vZGVGcmVxdWVuY3lVcGRhdGV9KTtcclxuICAgICAgICB0aGlzLnVwZGF0ZSh0cnVlKTtcclxuICAgIH1cclxufVxyXG5cclxud2luZG93Lm9ubG9hZCA9ICgpID0+IHtcclxuICAgIHZhciBhcHAgPSBuZXcgQXBwKCk7XHJcbn07IiwiY2xhc3MgU2FsbW9ucnVuVGltZVRpbWVyIHtcbiAgICBjb25zdHJ1Y3Rvcih0aW1lX29mZnNldCA9IG51bGwpIHtcbiAgICAgICAgdGhpcy50aW1lX29mZnNldCA9IHRpbWVfb2Zmc2V0O1xuICAgIH1cblxuICAgIC8vIOODhuOCueODiOOBl+OChOOBmeOBhOOCiOOBhuOBq+Wfuua6luOBruaXpeaZguOCkua4oeOBm+OCi+OCiOOBhuOBq+OBl+OBn1xuICAgIGxpc3R1cF9uZXh0X1NUVChkYXRlID0gRGF0ZS5ub3coKSkge1xuICAgICAgICB2YXIgbGlzdCA9IFtdO1xuICAgICAgICB2YXIgYmFzZTtcbiAgICAgICAgaWYgKHRoaXMudGltZV9vZmZzZXQpIHtcbiAgICAgICAgICAgIGJhc2UgPSB0aGlzLnRpbWVfb2Zmc2V0LmdldF90aW1lKGRhdGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYmFzZSA9IG5ldyBEYXRlKGRhdGUpO1xuICAgICAgICB9XG4gICAgICAgIC8vICBwZXJpb2QgfCAgIDAgICB8ICAgICAgICAgICAgMSAgICAgICAgICAgIHwgMiAgLi4uICA2IHwgICAgICAgICAgICA3ICAgICAgICAgICAgfCA4XG4gICAgICAgIC8vIG1pbnV0ZXMgfCAwMCAwMSB8IDAyIDAzIDA0IDA1IDA2IDA3IDA4IDA5IHwgMTAgLi4uIDQ5IHwgNTAgNTEgNTIgNTMgNTQgNTUgNTYgNTcgfCA1OCA1OVxuICAgICAgICB2YXIgcGVyaW9kID0gTWF0aC5mbG9vciggKGJhc2UuZ2V0TWludXRlcygpIC0gMikgLyA4KSArIDE7IC8vIGl0IGJlY29tZXMgMCB0byA4XG4gICAgICAgIFxuICAgICAgICAvLyBpbiB0aGlzIGhvdXIgKHVwdG8gMXN0KDowMiksMm5kKDoxMCksIC4uLiAsN3RoKDo1MCkpXG4gICAgICAgIHZhciBob3VycyA9IGJhc2UuZ2V0SG91cnMoKTtcblxuICAgICAgICAvLyBpdGVyYXRlIGFib3V0IGhvdXJzXG4gICAgICAgIGZvcig7IGxpc3QubGVuZ3RoIDwgNzsgKSB7XG4gICAgICAgICAgICAvLyBpbiB0aGlzIGhvdXJcbiAgICAgICAgICAgIC8vIGkg44GMIDgg44Gq44KJ5qyh44Gu5pmC6ZaT44G444CB44KC44GX44GP44GvIDcg5Lu25Z+L44G+44KM44Gw57WC5LqGXG4gICAgICAgICAgICBmb3IodmFyIGkgPSBwZXJpb2QrMTsgaSA8PSA3ICYmIGxpc3QubGVuZ3RoIDwgNzsgKytpKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1pbnV0ZXMgPSAyICsgKGktMSkgKiA4O1xuICAgICAgICAgICAgICAgIHZhciBkID0gbmV3IERhdGUoYmFzZSk7XG4gICAgICAgICAgICAgICAgZC5zZXRIb3Vycyhob3Vycyk7XG4gICAgICAgICAgICAgICAgZC5zZXRNaW51dGVzKG1pbnV0ZXMpO1xuICAgICAgICAgICAgICAgIGQuc2V0U2Vjb25kcygwKTtcbiAgICAgICAgICAgICAgICBkLnNldE1pbGxpc2Vjb25kcygwKTtcbiAgICAgICAgICAgICAgICBsaXN0LnB1c2goIGQgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGZvciBuZXh0IGhvdXJcbiAgICAgICAgICAgIHBlcmlvZCA9IDA7XG4gICAgICAgICAgICBob3VycyArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsaXN0O1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgU2FsbW9ucnVuVGltZVRpbWVyOyIsIi8vIGJhc2VkIG9uIGh0dHBzOi8vd3d3Lm5pY3QuZ28uanAvSlNUL0pTVDUuanNcblxudmFyIFNlcnZlckxpc3QgPSBbXG4gICAgXCJodHRwczovL250cC1hMS5uaWN0LmdvLmpwL2NnaS1iaW4vanNvblwiLFxuICAgIFwiaHR0cHM6Ly9udHAtYjEubmljdC5nby5qcC9jZ2ktYmluL2pzb25cIixcbiAgICBcImh0dHBzOi8vbnRwLWE0Lm5pY3QuZ28uanAvY2dpLWJpbi9qc29uXCJcbl07XG5pbXBvcnQgZ2V0SlNPTiBmcm9tIFwiZ2V0LWpzb24tZGF0YVwiO1xuXG5jbGFzcyBUaW1lT2Zmc2V0IHtcbiAgICBjb25zdHJ1Y3RvcihvZmZzZXRfZnJpZW5kID0gMCkge1xuICAgICAgICB0aGlzLm9mZnNldF9qc3QgPSAwO1xuICAgICAgICB0aGlzLnNldF9vZmZzZXRfZnJpZW5kKG9mZnNldF9mcmllbmQpO1xuICAgICAgICB0aGlzLmdldF9vZmZzZXRfanN0KCk7XG4gICAgfVxuXG4gICAgZ2V0X3RpbWUoZGF0ZSA9IERhdGUubm93KCkpIHtcbiAgICAgICAgdmFyIG9mZnNldCA9IDA7XG4gICAgICAgIGlmICh0aGlzLm9mZnNldF9qc3QpIHsgb2Zmc2V0ICs9IHRoaXMub2Zmc2V0X2pzdDsgfVxuICAgICAgICBpZiAodGhpcy5vZmZzZXRfZnJpZW5kICkgeyBvZmZzZXQgKz0gdGhpcy5vZmZzZXRfZnJpZW5kIDsgfVxuICAgICAgICByZXR1cm4gbmV3IERhdGUoZGF0ZSArIG9mZnNldCk7XG4gICAgfVxuICAgIFxuICAgIHNldF9vZmZzZXRfZnJpZW5kKG9mZnNldF9mcmllbmQpIHtcbiAgICAgICAgdGhpcy5vZmZzZXRfZnJpZW5kID0gb2Zmc2V0X2ZyaWVuZDtcbiAgICB9XG5cbiAgICBnZXRfb2Zmc2V0X2pzdCgpIHtcbiAgICAgICAgdGhpcy5yZXN1bHRzID0gbmV3IEFycmF5KCk7XG4gICAgICAgIGNvbnN0IHNlcnZlcl9ubyA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDMpO1xuICAgICAgICBjb25zdCBzZXJ2ZXJfYWRkciA9IFNlcnZlckxpc3Rbc2VydmVyX25vXTtcbiAgICAgICAgLy8g44Op44Oz44OA44Og44Gn5LiA44Gk44Gu44K144O844OQ44Gr44Ki44Kv44K744K544GZ44KM44Gw5Y2B5YiGXG4gICAgICAgIGdldEpTT04oc2VydmVyX2FkZHIgKyBcIj9cIiArICggKG5ldyBEYXRlKCkpLmdldFRpbWUoKSAvIDEwMDAgKSwgKGVyciwganNvbikgPT4ge1xuICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coU3RyaW5nKGVycikpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpO1x0IFx0XHQvLyBSZWNlaXZlIHRpbWVcbiAgICAgICAgICAgIGlmKCBqc29uLnN0ICYmIGpzb24uaXQgJiYganNvbi5sZWFwICYmIGpzb24ubmV4dCAmJiBqc29uLnN0ZXAgKSB7XG4gICAgICAgICAgICAgICAganNvbi5ydCA9IG5vdy5nZXRUaW1lKCk7IFx0XHQvLyBSZWNlaXZlIHRpbWVcbiAgICAgICAgICAgICAgICBqc29uLml0ID0gTnVtYmVyKGpzb24uaXQpICogMTAwMDsgXHQvLyBJbml0aWF0ZSB0aW1lXG4gICAgICAgICAgICAgICAganNvbi5zdCA9IE51bWJlcihqc29uLnN0KSAqIDEwMDA7IFx0Ly8gU2VuZCB0aW1lXG4gICAgICAgICAgICAgICAganNvbi5sYiA9IGpzb24uaXQgLSAxNiAtIGpzb24uc3Q7XHQvLyBlc3RpbWF0ZWQgbG93ZXIgYm91bmRcbiAgICAgICAgICAgICAgICBqc29uLnViID0ganNvbi5ydCArIDE2IC0ganNvbi5zdDtcdC8vIGVzdGltYXRlZCB1cHBlciBib3VuZFxuXG4gICAgICAgICAgICAgICAgLy8g6Kmw44G+44KL44Go44GT44KN5b+F6KaB44Gq44Gu44Gv5Lit5aSu44Gu5L+u5q2j5YCk44Gg44GRXG4gICAgICAgICAgICAgICAgdGhpcy5vZmZzZXRfanN0ID0gLSAoIGpzb24ubGIgKyBqc29uLnViICkgLyAyO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59XG5cblxuZXhwb3J0IGRlZmF1bHQgVGltZU9mZnNldDsiXSwic291cmNlUm9vdCI6IiJ9