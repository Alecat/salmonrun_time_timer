!function(e){var t={};function n(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./main.js")}({"../node_modules/get-json-data/index.js":
/*!**********************************************!*\
  !*** ../node_modules/get-json-data/index.js ***!
  \**********************************************/
/*! no static exports found */function(e,t){!function(){var t=function(e,t,n){var i;if(XMLHttpRequest)i=new XMLHttpRequest;else if(ActiveXObject)try{i=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{i=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}if(!i)return t.call(this,"Giving up :( Cannot create an XMLHTTP instance",null),!1;i.onreadystatechange=function(){if(4===i.readyState)if(i.status>=200&&i.status<400){var e=i.responseText;if(!(!(!n||!n.hasOwnProperty("raw"))&&n.raw))try{e=JSON.parse(e)}catch(e){return void t.call(this,e,null)}t.call(this,null,e)}else t.call(this,new Error("There was a problem with the request"),null)};var s=n&&n.method?n.method:"GET";if("GET"==s){var o=[];if(n&&n.params&&"object"==typeof n.params)for(var a in n.params)o.push(a+"="+encodeURIComponent(n.params[a]));e=o.length>0?e+"?"+o.join("&"):e,i.open("GET",e),i.send()}else if("POST"==s){var r=n&&n.data?n.data:n.params?n.params:{};i.open("POST",e),i.send(JSON.stringify(r))}return i};void 0!==e&&e.exports&&(e.exports=t),"undefined"!=typeof window&&(window.getJSONData=t)}()},"./config.js":
/*!*******************!*\
  !*** ./config.js ***!
  \*******************/
/*! exports provided: default */function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.r(t);var s=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.listener=t,this.scheme=n}return function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(e,[{key:"load",value:function(){var e=this;this.scheme;Object.keys(this.scheme).forEach(function(t){var n=e.scheme[t],i=n.type,s=n.default,o=localStorage[t];switch(void 0!=o&&null!=o||(o=s),i){case Boolean:e[t]="true"==o||1==o;break;case Number:e[t]=Number(o);break;case String:e[t]=String(o)}}),this.listener&&this.listener(this)}},{key:"save",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;t?Object.keys(t).forEach(function(e){localStorage[e]=t[e]}):Object.keys(this.scheme).forEach(function(t){localStorage[t]=e[t]})}}]),e}();t.default=s},"./date_formatter.js":
/*!***************************!*\
  !*** ./date_formatter.js ***!
  \***************************/
/*! exports provided: default */function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.r(t);var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(e,[{key:"getMonthText",value:function(e){var t=e.getMonth()+1,n=e.getDate();t<10&&(t="0"+t),n<10&&(n="0"+n);var i=e.getHours(),s=e.getMinutes(),o=e.getSeconds();return i<10&&(i="0"+i),s<10&&(s="0"+s),o<10&&(o="0"+o),t+"/"+n+" "+i+":"+s+":"+o}},{key:"getMinText",value:function(e){var t=e.getMinutes(),n=e.getSeconds(),i=e.getMilliseconds();return t<10&&(t="0"+t),n<10&&(n="0"+n),i<10?i="00"+i:i<100&&(i="0"+i),t+":"+n+"."+i}}]),e}();t.default=s},"./main.js":
/*!*****************!*\
  !*** ./main.js ***!
  \*****************/
/*! no exports provided */function(e,t,n){"use strict";n.r(t);var i=n(/*! ./salmonrun_time_timer */"./salmonrun_time_timer.js"),s=n(/*! ./date_formatter */"./date_formatter.js"),o=n(/*! ./time_offset */"./time_offset.js"),a=n(/*! ./config */"./config.js");function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var l=new s.default,f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time_offset=new o.default,this.timer=new i.default(this.time_offset),this.config=new a.default(this.on_load.bind(this),{mode_friend:{type:Boolean,default:!1}}),this.elmEta=document.getElementById("eta"),this.elmModeFriend=document.getElementById("mode_friend"),this.elmEtaArea=document.getElementById("eta_area"),this.elmEtaLabel=document.getElementById("eta_label"),this.elmOffset=document.getElementById("offset"),this.config.load(),this.elmModeFriend.onclick=this.on_change_modeFriend.bind(this)}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(e,[{key:"calc_eta",value:function(){this.list=this.timer.listup_next_STT();var e=this.time_offset.get_time(),t=this.list[0]-e;this.eta=new Date(t)}},{key:"update_eta",value:function(){var e=l.getMinText(this.eta);this.elmEta.innerHTML=e;var t="ST";if(0!=this.time_offset.offset_friend&&(t+="(フレ部屋)"),t+="まで",this.elmEtaLabel.innerHTML=t,this.time_offset.offset_jst){var n="補正: ";this.time_offset.offset_jst<0?n+="-"+l.getMinText(new Date(-this.time_offset.offset_jst)):n+="+"+l.getMinText(new Date(this.time_offset.offset_jst)),0!=this.time_offset.offset_friend&&(n+=" (2秒遅れ)"),this.elmOffset.innerHTML=n}else this.elmOffset.innerHTML="時刻合わせ中 ..."}},{key:"update_list",value:function(){for(var e in this.list){var t=document.getElementById("stt-item-"+(Number(e)+1)),n=l.getMonthText(this.list[e]);t.innerHTML=n}}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.calc_eta(),this.update_eta(),this.update_list(),e){var t=1e3;this.eta<6e4&&(t=50),setTimeout(this.update.bind(this,!0),t)}}},{key:"on_load",value:function(e){this.elmModeFriend.checked=e.mode_friend,this.on_change_modeFriend()}},{key:"on_change_modeFriend",value:function(){var e=this.elmModeFriend.checked;this.elmEtaArea.classList.remove("mdl-color--grey-800"),this.elmEtaArea.classList.remove("mdl-color--green-900"),this.elmEtaLabel.classList.remove("mdl-color-text--grey-600"),this.elmEtaLabel.classList.remove("mdl-color-text--yellow-600"),this.elmOffset.classList.remove("mdl-color-text--grey-600"),this.elmOffset.classList.remove("mdl-color-text--yellow-600"),e?(this.time_offset.set_offset_friend(-2e3),this.elmEtaArea.classList.add("mdl-color--green-900"),this.elmEtaLabel.classList.add("mdl-color-text--yellow-600"),this.elmOffset.classList.add("mdl-color-text--yellow-600")):(this.time_offset.set_offset_friend(0),this.elmEtaArea.classList.add("mdl-color--grey-800"),this.elmEtaLabel.classList.add("mdl-color-text--grey-600"),this.elmOffset.classList.add("mdl-color-text--grey-600"));var t={mode_friend:e};this.config.save(t),this.update(!1)}}]),e}();window.onload=function(){(new f).update(!0)}},"./salmonrun_time_timer.js":
/*!*********************************!*\
  !*** ./salmonrun_time_timer.js ***!
  \*********************************/
/*! exports provided: default */function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.r(t);var s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time_offset=t}return function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(e,[{key:"listup_next_STT",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),n=[];e=this.time_offset?this.time_offset.get_time(t):new Date(t);for(var i=Math.floor((e.getMinutes()-2)/8)+1,s=e.getHours();n.length<7;){for(var o=i+1;o<=7&&n.length<7;++o){var a=2+8*(o-1),r=new Date(e);r.setHours(s),r.setMinutes(a),r.setSeconds(0),r.setMilliseconds(0),n.push(r)}i=0,s+=1}return n}}]),e}();t.default=s},"./time_offset.js":
/*!************************!*\
  !*** ./time_offset.js ***!
  \************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var i=n(/*! get-json-data */"../node_modules/get-json-data/index.js"),s=n.n(i);function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=["https://ntp-a1.nict.go.jp/cgi-bin/json","https://ntp-b1.nict.go.jp/cgi-bin/json","https://ntp-a4.nict.go.jp/cgi-bin/json"],r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.offset_jst=0,this.set_offset_friend(t),this.get_offset_jst()}return function(e,t,n){t&&o(e.prototype,t),n&&o(e,n)}(e,[{key:"get_time",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=0;return this.offset_jst&&(t+=this.offset_jst),this.offset_friend&&(t+=this.offset_friend),new Date(e+t)}},{key:"set_offset_friend",value:function(e){this.offset_friend=e}},{key:"get_offset_jst",value:function(){var e=this;this.results=new Array;var t=Math.floor(3*Math.random()),n=a[t];s()(n+"?"+(new Date).getTime()/1e3,function(t,n){if(!t){var i=new Date;n.st&&n.it&&n.leap&&n.next&&n.step&&(n.rt=i.getTime(),n.it=1e3*Number(n.it),n.st=1e3*Number(n.st),n.lb=n.it-16-n.st,n.ub=n.rt+16-n.st,e.offset_jst=-(n.lb+n.ub)/2)}})}}]),e}();t.default=r}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy9nZXQtanNvbi1kYXRhL2luZGV4LmpzIiwid2VicGFjazovLy8uL2NvbmZpZy5qcyIsIndlYnBhY2s6Ly8vLi9kYXRlX2Zvcm1hdHRlci5qcyIsIndlYnBhY2s6Ly8vLi9tYWluLmpzIiwid2VicGFjazovLy8uL3NhbG1vbnJ1bl90aW1lX3RpbWVyLmpzIiwid2VicGFjazovLy8uL3RpbWVfb2Zmc2V0LmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsInZhbHVlIiwibiIsIl9fZXNNb2R1bGUiLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJtYWtlUmVxdWVzdCIsInVybCIsImNhbGxiYWNrIiwib3B0IiwieGhyIiwiWE1MSHR0cFJlcXVlc3QiLCJBY3RpdmVYT2JqZWN0IiwiZSIsInRoaXMiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCJyZWFkeVN0YXRlIiwic3RhdHVzIiwiZGF0YSIsInJlc3BvbnNlVGV4dCIsInJhdyIsIkpTT04iLCJwYXJzZSIsIkVycm9yIiwibWV0aG9kIiwicGFyYW1zIiwia2V5IiwicHVzaCIsImVuY29kZVVSSUNvbXBvbmVudCIsImxlbmd0aCIsImpvaW4iLCJvcGVuIiwic2VuZCIsInN0cmluZ2lmeSIsIndpbmRvdyIsImdldEpTT05EYXRhIiwiQ29uZmlnIiwibGlzdGVuZXIiLCJzY2hlbWUiLCJfY2xhc3NDYWxsQ2hlY2siLCJfdGhpcyIsImtleXMiLCJmb3JFYWNoIiwiaW5mbyIsInR5cGUiLCJkZWYiLCJsb2NhbFN0b3JhZ2UiLCJ1bmRlZmluZWQiLCJCb29sZWFuIiwiTnVtYmVyIiwiU3RyaW5nIiwiX3RoaXMyIiwicGFydGlhbCIsImFyZ3VtZW50cyIsIkRhdGVGb3JtYXR0ZXIiLCJNTSIsImdldE1vbnRoIiwiREQiLCJnZXREYXRlIiwiaGgiLCJnZXRIb3VycyIsIm1tIiwiZ2V0TWludXRlcyIsInNzIiwiZ2V0U2Vjb25kcyIsIlNTUyIsImdldE1pbGxpc2Vjb25kcyIsImRhdGVfZm9ybWF0dGVyIiwiQXBwIiwidGltZV9vZmZzZXQiLCJUaW1lT2Zmc2V0IiwidGltZXIiLCJTYWxtb25ydW5UaW1lVGltZXIiLCJjb25maWciLCJvbl9sb2FkIiwiYmluZCIsIm1vZGVfZnJpZW5kIiwiZGVmYXVsdCIsImVsbUV0YSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJlbG1Nb2RlRnJpZW5kIiwiZWxtRXRhQXJlYSIsImVsbUV0YUxhYmVsIiwiZWxtT2Zmc2V0IiwibG9hZCIsIm9uY2xpY2siLCJvbl9jaGFuZ2VfbW9kZUZyaWVuZCIsImxpc3QiLCJsaXN0dXBfbmV4dF9TVFQiLCJub3ciLCJnZXRfdGltZSIsImV0YSIsIkRhdGUiLCJ0ZXh0RXRhIiwiZ2V0TWluVGV4dCIsImlubmVySFRNTCIsImxhYmVsVGV4dCIsIm9mZnNldF9mcmllbmQiLCJvZmZzZXRfanN0IiwidGV4dE9mZnNldCIsImVsbVNUVCIsInRleHRTVFQiLCJnZXRNb250aFRleHQiLCJsb29wIiwiY2FsY19ldGEiLCJ1cGRhdGVfZXRhIiwidXBkYXRlX2xpc3QiLCJpbnRlcnZhbCIsInNldFRpbWVvdXQiLCJ1cGRhdGUiLCJjaGVja2VkIiwibW9kZUZyaWVuZCIsImNsYXNzTGlzdCIsInJlbW92ZSIsInNldF9vZmZzZXRfZnJpZW5kIiwiYWRkIiwic2F2ZSIsIm9ubG9hZCIsImJhc2UiLCJkYXRlIiwicGVyaW9kIiwiTWF0aCIsImZsb29yIiwiaG91cnMiLCJtaW51dGVzIiwic2V0SG91cnMiLCJzZXRNaW51dGVzIiwic2V0U2Vjb25kcyIsInNldE1pbGxpc2Vjb25kcyIsIlNlcnZlckxpc3QiLCJnZXRfb2Zmc2V0X2pzdCIsIm9mZnNldCIsInJlc3VsdHMiLCJBcnJheSIsInNlcnZlcl9ubyIsInJhbmRvbSIsInNlcnZlcl9hZGRyIiwiZ2V0SlNPTiIsImdldFRpbWUiLCJlcnIiLCJqc29uIiwic3QiLCJpdCIsImxlYXAiLCJuZXh0Iiwic3RlcCIsInJ0IiwibGIiLCJ1YiJdLCJtYXBwaW5ncyI6ImFBQ0EsSUFBQUEsS0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQUMsUUFHQSxJQUFBQyxFQUFBSixFQUFBRSxJQUNBRyxFQUFBSCxFQUNBSSxHQUFBLEVBQ0FILFlBVUEsT0FOQUksRUFBQUwsR0FBQU0sS0FBQUosRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUYsR0FHQUcsRUFBQUUsR0FBQSxFQUdBRixFQUFBRCxRQUtBRixFQUFBUSxFQUFBRixFQUdBTixFQUFBUyxFQUFBVixFQUdBQyxFQUFBVSxFQUFBLFNBQUFSLEVBQUFTLEVBQUFDLEdBQ0FaLEVBQUFhLEVBQUFYLEVBQUFTLElBQ0FHLE9BQUFDLGVBQUFiLEVBQUFTLEdBQ0FLLGNBQUEsRUFDQUMsWUFBQSxFQUNBQyxJQUFBTixLQU1BWixFQUFBbUIsRUFBQSxTQUFBakIsR0FDQVksT0FBQUMsZUFBQWIsRUFBQSxjQUFpRGtCLE9BQUEsS0FJakRwQixFQUFBcUIsRUFBQSxTQUFBbEIsR0FDQSxJQUFBUyxFQUFBVCxLQUFBbUIsV0FDQSxXQUEyQixPQUFBbkIsRUFBQSxTQUMzQixXQUFpQyxPQUFBQSxHQUVqQyxPQURBSCxFQUFBVSxFQUFBRSxFQUFBLElBQUFBLEdBQ0FBLEdBSUFaLEVBQUFhLEVBQUEsU0FBQVUsRUFBQUMsR0FBc0QsT0FBQVYsT0FBQVcsVUFBQUMsZUFBQW5CLEtBQUFnQixFQUFBQyxJQUd0RHhCLEVBQUEyQixFQUFBLEdBSUEzQixJQUFBNEIsRUFBQTs7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QWNpQyxHQUFVdEgsS0FBS3FGLFlBQ2xDckYsS0FBS29GLGdCQUFrQmtDLEdBQVV0SCxLQUFLb0YsZUFDbkMsSUFBSUwsS0FBSzJCLEVBQU9ZLDZDQUdUbEMsR0FDZHBGLEtBQUtvRixjQUFnQkEsMkNBR1IsSUFBQTFELEVBQUExQixLQUNiQSxLQUFLdUgsUUFBVSxJQUFJQyxNQUNuQixJQUFNQyxFQUFZYixLQUFLQyxNQUFzQixFQUFoQkQsS0FBS2MsVUFDNUJDLEVBQWNQLEVBQVdLLEdBRS9CRyxJQUFRRCxFQUFjLEtBQVMsSUFBSTVDLE1BQVE4QyxVQUFZLElBQVEsU0FBQ0MsRUFBS0MsR0FDakUsSUFBSUQsRUFBSixDQUlBLElBQUlsRCxFQUFNLElBQUlHLEtBQ1ZnRCxFQUFLQyxJQUFNRCxFQUFLRSxJQUFNRixFQUFLRyxNQUFRSCxFQUFLSSxNQUFRSixFQUFLSyxPQUNyREwsRUFBS00sR0FBS3pELEVBQUlpRCxVQUNkRSxFQUFLRSxHQUF1QixJQUFsQjlGLE9BQU80RixFQUFLRSxJQUN0QkYsRUFBS0MsR0FBdUIsSUFBbEI3RixPQUFPNEYsRUFBS0MsSUFDdEJELEVBQUtPLEdBQUtQLEVBQUtFLEdBQUssR0FBS0YsRUFBS0MsR0FDOUJELEVBQUtRLEdBQUtSLEVBQUtNLEdBQUssR0FBS04sRUFBS0MsR0FHOUJ0RyxFQUFLMkQsYUFBaUIwQyxFQUFLTyxHQUFLUCxFQUFLUSxJQUFPLGVBTzdDL0UiLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbiBcdFx0XHRcdGdldDogZ2V0dGVyXG4gXHRcdFx0fSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSBcIi4vbWFpbi5qc1wiKTtcbiIsIi8vIGdldC1qc29uLWRhdGFcbi8vY29kZSBmcm9tIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvQUpBWC9HZXR0aW5nX1N0YXJ0ZWRcbihmdW5jdGlvbigpIHtcbiAgdmFyIG1ha2VSZXF1ZXN0ID0gZnVuY3Rpb24odXJsLGNhbGxiYWNrLG9wdCkge1xuICAgIHZhciB4aHI7XG4gICAgaWYgKFhNTEh0dHBSZXF1ZXN0KSB7IC8vIE1vemlsbGEsIFNhZmFyaSwgLi4uXG4gICAgICB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICB9IGVsc2UgaWYgKEFjdGl2ZVhPYmplY3QpIHsgLy8gSUVcbiAgICAgIHRyeSB7XG4gICAgICAgIHhociA9IG5ldyBBY3RpdmVYT2JqZWN0KFwiTXN4bWwyLlhNTEhUVFBcIik7XG4gICAgICB9IFxuICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICB4aHIgPSBuZXcgQWN0aXZlWE9iamVjdChcIk1pY3Jvc29mdC5YTUxIVFRQXCIpO1xuICAgICAgICB9IFxuICAgICAgICBjYXRjaCAoZSkge31cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIXhocikge1xuICAgICAgY2FsbGJhY2suY2FsbCh0aGlzLFxuICAgICAgICAnR2l2aW5nIHVwIDooIENhbm5vdCBjcmVhdGUgYW4gWE1MSFRUUCBpbnN0YW5jZScsXG4gICAgICAgIG51bGwpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT09IDQpIHtcbiAgICAgICAgaWYgKHhoci5zdGF0dXMgPj0gMjAwICYmIHhoci5zdGF0dXMgPDQwMCkge1xuICAgICAgICAgIHZhciBkYXRhID0geGhyLnJlc3BvbnNlVGV4dCxcbiAgICAgICAgICAgIHJhdyA9IG9wdCAmJiBvcHQuaGFzT3duUHJvcGVydHkoJ3JhdycpID8gb3B0LnJhdyA6IGZhbHNlOyAgXG4gICAgICAgICAgaWYoIXJhdykge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgZGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgIGNhbGxiYWNrLmNhbGwodGhpcywgZSxudWxsKTtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBjYWxsYmFjay5jYWxsKHRoaXMsbnVsbCxkYXRhKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjYWxsYmFjay5jYWxsKHRoaXMsXG4gICAgICAgICAgICBuZXcgRXJyb3IoJ1RoZXJlIHdhcyBhIHByb2JsZW0gd2l0aCB0aGUgcmVxdWVzdCcpLFxuICAgICAgICAgICAgbnVsbCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICAgIHZhciBtZXRob2QgPSBvcHQgJiYgb3B0Lm1ldGhvZCA/IG9wdC5tZXRob2QgOiAnR0VUJztcbiAgICBpZiAobWV0aG9kID09ICdHRVQnKSB7IFxuICAgICAgdmFyIHBhcmFtcyA9IFtdO1xuICAgICAgaWYgKG9wdCAmJiBvcHQucGFyYW1zICYmIHR5cGVvZihvcHQucGFyYW1zKSA9PSAnb2JqZWN0Jykge1xuICAgICAgICBmb3IoIHZhciBrZXkgaW4gb3B0LnBhcmFtcykge1xuICAgICAgICAgIHBhcmFtcy5wdXNoKGtleSArJz0nKyBlbmNvZGVVUklDb21wb25lbnQob3B0LnBhcmFtc1trZXldKSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHVybCA9IHBhcmFtcy5sZW5ndGggPiAwID8gdXJsKyc/JytwYXJhbXMuam9pbignJicpIDogdXJsO1xuICAgICAgeGhyLm9wZW4oJ0dFVCcsIHVybCk7XG4gICAgICB4aHIuc2VuZCgpO1xuICAgIH0gZWxzZSBpZiAobWV0aG9kID09ICdQT1NUJykge1xuICAgICAgdmFyIGRhdGEgPSBvcHQgJiYgb3B0LmRhdGEgPyBvcHQuZGF0YSA6IG9wdC5wYXJhbXMgPyBvcHQucGFyYW1zIDoge307XG4gICAgICB4aHIub3BlbignUE9TVCcsIHVybCk7XG4gICAgICB4aHIuc2VuZChKU09OLnN0cmluZ2lmeShkYXRhKSk7XG4gICAgfVxuICAgIHJldHVybiB4aHI7XG4gIH1cblxuICBpZih0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiBtb2R1bGUuZXhwb3J0cykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gbWFrZVJlcXVlc3Q7XG4gIH1cbiAgaWYodHlwZW9mIHdpbmRvdyE9PSAndW5kZWZpbmVkJykge1xuICAgIHdpbmRvdy5nZXRKU09ORGF0YSA9IG1ha2VSZXF1ZXN0O1xuICB9IFxufSkoKTtcbiIsIlxyXG5cclxuY2xhc3MgQ29uZmlnIHtcclxuICAgIGNvbnN0cnVjdG9yKGxpc3RlbmVyLCBzY2hlbWUpIHtcclxuICAgICAgICB0aGlzLmxpc3RlbmVyID0gbGlzdGVuZXI7XHJcbiAgICAgICAgdGhpcy5zY2hlbWUgPSBzY2hlbWU7XHJcbiAgICB9XHJcbiAgICBsb2FkKCkge1xyXG4gICAgICAgIGNvbnN0IHNjaGVtZSA9IHRoaXMuc2NoZW1lO1xyXG4gICAgICAgIE9iamVjdC5rZXlzKHRoaXMuc2NoZW1lKS5mb3JFYWNoKGtleSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGluZm8gPSB0aGlzLnNjaGVtZVtrZXldO1xyXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMpXHJcbiAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBpbmZvW1widHlwZVwiXTtcclxuICAgICAgICAgICAgY29uc3QgZGVmICA9IGluZm9bXCJkZWZhdWx0XCJdO1xyXG5cclxuICAgICAgICAgICAgdmFyIHZhbHVlID0gbG9jYWxTdG9yYWdlW2tleV07XHJcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PSB1bmRlZmluZWQgfHwgdmFsdWUgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgdmFsdWUgPSBkZWY7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN3aXRjaCh0eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIEJvb2xlYW46XHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpc1trZXldID0gKHZhbHVlID09ICd0cnVlJyB8fCB2YWx1ZSA9PSB0cnVlKSA/IHRydWUgOiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhc2UgTnVtYmVyOlxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXNba2V5XSA9IE51bWJlcih2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXNlIFN0cmluZzpcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzW2tleV0gPSBTdHJpbmcodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKHRoaXMubGlzdGVuZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5saXN0ZW5lcih0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBzYXZlKHBhcnRpYWw9dW5kZWZpbmVkKSB7XHJcbiAgICAgICAgaWYgKHBhcnRpYWwpIHtcclxuICAgICAgICAgICAgT2JqZWN0LmtleXMocGFydGlhbCkuZm9yRWFjaChrZXkgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhsb2NhbFN0b3JhZ2Vba2V5XSApO1xyXG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlW2tleV0gPSBwYXJ0aWFsW2tleV07XHJcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGtleSApO1xyXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhsb2NhbFN0b3JhZ2Vba2V5XSApO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBPYmplY3Qua2V5cyh0aGlzLnNjaGVtZSkuZm9yRWFjaChrZXkgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhsb2NhbFN0b3JhZ2Vba2V5XSApO1xyXG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlW2tleV0gPSB0aGlzW2tleV07XHJcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGtleSApO1xyXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhsb2NhbFN0b3JhZ2Vba2V5XSApO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IENvbmZpZzsiLCJjbGFzcyBEYXRlRm9ybWF0dGVyIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICB9XG5cbiAgICBnZXRNb250aFRleHQoZClcbiAgICB7XG4gICAgICAgIHZhciBNTSA9IGQuZ2V0TW9udGgoKSArIDE7XG4gICAgICAgIHZhciBERCA9IGQuZ2V0RGF0ZSgpO1xuICAgICAgICBpZiAoTU0gPCAxMCkgTU0gPSBcIjBcIiArIE1NO1xuICAgICAgICBpZiAoREQgPCAxMCkgREQgPSBcIjBcIiArIEREO1xuXG4gICAgICAgIHZhciBoaCA9IGQuZ2V0SG91cnMoKTtcbiAgICAgICAgdmFyIG1tID0gZC5nZXRNaW51dGVzKCk7XG4gICAgICAgIHZhciBzcyA9IGQuZ2V0U2Vjb25kcygpO1xuXG4gICAgICAgIGlmIChoaCA8IDEwKSBoaCA9IFwiMFwiICsgaGg7XG4gICAgICAgIGlmIChtbSA8IDEwKSBtbSA9IFwiMFwiICsgbW07XG4gICAgICAgIGlmIChzcyA8IDEwKSBzcyA9IFwiMFwiICsgc3M7XG5cbiAgICAgICAgcmV0dXJuICggTU0gKyBcIi9cIiArIEREICsgXCIgXCIgKyBoaCArIFwiOlwiICsgbW0gKyBcIjpcIiArIHNzKTtcbiAgICB9XG4gICAgZ2V0TWluVGV4dChkKVxuICAgIHtcbiAgICAgICAgdmFyIG1tID0gZC5nZXRNaW51dGVzKCk7XG4gICAgICAgIHZhciBzcyA9IGQuZ2V0U2Vjb25kcygpO1xuICAgICAgICB2YXIgU1NTID0gZC5nZXRNaWxsaXNlY29uZHMoKTtcblxuICAgICAgICBpZiAobW0gPCAxMCkgbW0gPSBcIjBcIiArIG1tO1xuICAgICAgICBpZiAoc3MgPCAxMCkgc3MgPSBcIjBcIiArIHNzO1xuICAgICAgICBpZiAgICAgIChTU1MgPCAgMTApIHsgU1NTID0gXCIwMFwiICsgU1NTOyB9XG4gICAgICAgIGVsc2UgaWYgKFNTUyA8IDEwMCkgeyBTU1MgPSBcIjBcIiArIFNTUzsgfVxuXG4gICAgICAgIHJldHVybiAobW0gKyBcIjpcIiArIHNzICsgXCIuXCIgKyBTU1MpO1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRGF0ZUZvcm1hdHRlcjtcbiIsImltcG9ydCBTYWxtb25ydW5UaW1lVGltZXIgZnJvbSBcIi4vc2FsbW9ucnVuX3RpbWVfdGltZXJcIjtcbmltcG9ydCBEYXRlRm9ybWF0dGVyIGZyb20gXCIuL2RhdGVfZm9ybWF0dGVyXCI7XG5pbXBvcnQgVGltZU9mZnNldCBmcm9tIFwiLi90aW1lX29mZnNldFwiO1xuaW1wb3J0IENvbmZpZyBmcm9tIFwiLi9jb25maWdcIjtcblxuY29uc3QgZGF0ZV9mb3JtYXR0ZXIgPSBuZXcgRGF0ZUZvcm1hdHRlcigpO1xuXG5jbGFzcyBBcHAge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnRpbWVfb2Zmc2V0ID0gbmV3IFRpbWVPZmZzZXQoKTtcbiAgICAgICAgdGhpcy50aW1lciA9IG5ldyBTYWxtb25ydW5UaW1lVGltZXIodGhpcy50aW1lX29mZnNldCk7XG4gICAgICAgIHRoaXMuY29uZmlnID0gbmV3IENvbmZpZyh0aGlzLm9uX2xvYWQuYmluZCh0aGlzKSwge1xuICAgICAgICAgICAgXCJtb2RlX2ZyaWVuZFwiOiB7XCJ0eXBlXCI6IEJvb2xlYW4sIFwiZGVmYXVsdFwiOiBmYWxzZX0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuZWxtRXRhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJldGFcIik7XG4gICAgICAgIHRoaXMuZWxtTW9kZUZyaWVuZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibW9kZV9mcmllbmRcIik7XG4gICAgICAgIHRoaXMuZWxtRXRhQXJlYSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZXRhX2FyZWFcIik7XG4gICAgICAgIHRoaXMuZWxtRXRhTGFiZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImV0YV9sYWJlbFwiKTtcbiAgICAgICAgdGhpcy5lbG1PZmZzZXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm9mZnNldFwiKTtcblxuICAgICAgICB0aGlzLmNvbmZpZy5sb2FkKCk7XG4gICAgICAgIHRoaXMuZWxtTW9kZUZyaWVuZC5vbmNsaWNrID0gdGhpcy5vbl9jaGFuZ2VfbW9kZUZyaWVuZC5iaW5kKHRoaXMpO1xuXG5cbiAgICB9XG4gICAgY2FsY19ldGEoKSB7XG4gICAgICAgIHRoaXMubGlzdCA9IHRoaXMudGltZXIubGlzdHVwX25leHRfU1RUKCk7XG4gICAgICAgIGNvbnN0IG5vdyA9IHRoaXMudGltZV9vZmZzZXQuZ2V0X3RpbWUoKTtcbiAgICAgICAgdmFyIGV0YSA9IHRoaXMubGlzdFswXSAtIG5vdztcbiAgICAgICAgdGhpcy5ldGEgPSBuZXcgRGF0ZShldGEpO1xuICAgIH1cbiAgICB1cGRhdGVfZXRhKCkge1xuICAgICAgICAvLyBldGFcbiAgICAgICAgY29uc3QgdGV4dEV0YSA9IGRhdGVfZm9ybWF0dGVyLmdldE1pblRleHQodGhpcy5ldGEpO1xuICAgICAgICB0aGlzLmVsbUV0YS5pbm5lckhUTUwgPSB0ZXh0RXRhO1xuICAgICAgICAvLyBzaG93IGxhYmVsXG5cbiAgICAgICAgbGV0IGxhYmVsVGV4dCA9ICdTVCc7XG4gICAgICAgIGlmICh0aGlzLnRpbWVfb2Zmc2V0Lm9mZnNldF9mcmllbmQgIT0gMCkge1xuICAgICAgICAgICAgbGFiZWxUZXh0ICs9ICco44OV44Os6YOo5bGLKSc7XG4gICAgICAgIH1cbiAgICAgICAgbGFiZWxUZXh0ICs9ICfjgb7jgacnO1xuICAgICAgICB0aGlzLmVsbUV0YUxhYmVsLmlubmVySFRNTCA9IGxhYmVsVGV4dDtcbiAgICAgICAgLy8gc2hvdyBvZmZzZXQgdGV4dFxuICAgICAgICBpZiAodGhpcy50aW1lX29mZnNldC5vZmZzZXRfanN0KSB7XG4gICAgICAgICAgICB2YXIgdGV4dE9mZnNldCA9ICfoo5zmraM6ICc7XG4gICAgICAgICAgICBpZiAodGhpcy50aW1lX29mZnNldC5vZmZzZXRfanN0IDwgMCkge1xuICAgICAgICAgICAgICAgIHRleHRPZmZzZXQgKz0gXCItXCIgKyBkYXRlX2Zvcm1hdHRlci5nZXRNaW5UZXh0KG5ldyBEYXRlKC10aGlzLnRpbWVfb2Zmc2V0Lm9mZnNldF9qc3QpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGV4dE9mZnNldCArPSBcIitcIiArIGRhdGVfZm9ybWF0dGVyLmdldE1pblRleHQobmV3IERhdGUodGhpcy50aW1lX29mZnNldC5vZmZzZXRfanN0KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy50aW1lX29mZnNldC5vZmZzZXRfZnJpZW5kICE9IDApIHtcbiAgICAgICAgICAgICAgICB0ZXh0T2Zmc2V0ICs9IFwiICgy56eS6YGF44KMKVwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5lbG1PZmZzZXQuaW5uZXJIVE1MID0gdGV4dE9mZnNldDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZWxtT2Zmc2V0LmlubmVySFRNTCA9IFwi5pmC5Yi75ZCI44KP44Gb5LitIC4uLlwiO1xuICAgICAgICB9XG4gICAgfVxuICAgIHVwZGF0ZV9saXN0KCkge1xuICAgICAgICAvLyBsaXN0XG4gICAgICAgIGZvciAobGV0IGkgaW4gdGhpcy5saXN0KSB7XG4gICAgICAgICAgICBjb25zdCBlbG1TVFQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInN0dC1pdGVtLVwiICsgKE51bWJlcihpKSArIDEpKTtcbiAgICAgICAgICAgIGNvbnN0IHRleHRTVFQgPSBkYXRlX2Zvcm1hdHRlci5nZXRNb250aFRleHQodGhpcy5saXN0W2ldKTtcbiAgICAgICAgICAgIGVsbVNUVC5pbm5lckhUTUwgPSB0ZXh0U1RUO1xuICAgICAgICB9XG4gICAgfVxuICAgIHVwZGF0ZShsb29wID0gZmFsc2UpIHtcbiAgICAgICAgdGhpcy5jYWxjX2V0YSgpO1xuICAgICAgICB0aGlzLnVwZGF0ZV9ldGEoKTtcbiAgICAgICAgdGhpcy51cGRhdGVfbGlzdCgpO1xuXG4gICAgICAgIGlmIChsb29wKSB7XG4gICAgICAgICAgICB2YXIgaW50ZXJ2YWwgPSAxMDAwO1xuICAgICAgICAgICAgaWYgKHRoaXMuZXRhIDwgNjAgKiAxMDAwKSB7XG4gICAgICAgICAgICAgICAgaW50ZXJ2YWwgPSA1MDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNldFRpbWVvdXQodGhpcy51cGRhdGUuYmluZCh0aGlzLCB0cnVlKSwgaW50ZXJ2YWwpO1xuICAgICAgICB9XG4gICAgfVxuICAgIG9uX2xvYWQoY29uZmlnKSB7XG4gICAgICAgIHRoaXMuZWxtTW9kZUZyaWVuZC5jaGVja2VkID0gY29uZmlnW1wibW9kZV9mcmllbmRcIl07XG4gICAgICAgIHRoaXMub25fY2hhbmdlX21vZGVGcmllbmQoKTtcblxuICAgIH1cbiAgICBvbl9jaGFuZ2VfbW9kZUZyaWVuZCgpIHtcbiAgICAgICAgY29uc3QgY2xhc3NGb3JOb3JuYWxNb2RlQmFjayA9ICdtZGwtY29sb3ItLWdyZXktODAwJztcbiAgICAgICAgY29uc3QgY2xhc3NGb3JGcmllbmRNb2RlQmFjayA9ICdtZGwtY29sb3ItLWdyZWVuLTkwMCc7XG4gICAgICAgIGNvbnN0IGNsYXNzRm9yTm9ybmFsTW9kZUZvcmUgPSAnbWRsLWNvbG9yLXRleHQtLWdyZXktNjAwJztcbiAgICAgICAgY29uc3QgY2xhc3NGb3JGcmllbmRNb2RlRm9yZSA9ICdtZGwtY29sb3ItdGV4dC0teWVsbG93LTYwMCc7XG5cbiAgICAgICAgY29uc3QgbW9kZUZyaWVuZCA9IHRoaXMuZWxtTW9kZUZyaWVuZC5jaGVja2VkO1xuICAgICAgICB0aGlzLmVsbUV0YUFyZWEuY2xhc3NMaXN0LnJlbW92ZShjbGFzc0Zvck5vcm5hbE1vZGVCYWNrKTtcbiAgICAgICAgdGhpcy5lbG1FdGFBcmVhLmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NGb3JGcmllbmRNb2RlQmFjayk7XG5cbiAgICAgICAgdGhpcy5lbG1FdGFMYWJlbC5jbGFzc0xpc3QucmVtb3ZlKGNsYXNzRm9yTm9ybmFsTW9kZUZvcmUpO1xuICAgICAgICB0aGlzLmVsbUV0YUxhYmVsLmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NGb3JGcmllbmRNb2RlRm9yZSk7XG4gICAgICAgIHRoaXMuZWxtT2Zmc2V0LmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NGb3JOb3JuYWxNb2RlRm9yZSk7XG4gICAgICAgIHRoaXMuZWxtT2Zmc2V0LmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NGb3JGcmllbmRNb2RlRm9yZSk7XG4gICAgICAgIGlmIChtb2RlRnJpZW5kKSB7XG4gICAgICAgICAgICB0aGlzLnRpbWVfb2Zmc2V0LnNldF9vZmZzZXRfZnJpZW5kKC0yICogMTAwMCk7XG4gICAgICAgICAgICB0aGlzLmVsbUV0YUFyZWEuY2xhc3NMaXN0LmFkZChjbGFzc0ZvckZyaWVuZE1vZGVCYWNrKTtcbiAgICAgICAgICAgIHRoaXMuZWxtRXRhTGFiZWwuY2xhc3NMaXN0LmFkZChjbGFzc0ZvckZyaWVuZE1vZGVGb3JlKTtcbiAgICAgICAgICAgIHRoaXMuZWxtT2Zmc2V0LmNsYXNzTGlzdC5hZGQoY2xhc3NGb3JGcmllbmRNb2RlRm9yZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMudGltZV9vZmZzZXQuc2V0X29mZnNldF9mcmllbmQoMCk7XG4gICAgICAgICAgICB0aGlzLmVsbUV0YUFyZWEuY2xhc3NMaXN0LmFkZChjbGFzc0Zvck5vcm5hbE1vZGVCYWNrKTtcbiAgICAgICAgICAgIHRoaXMuZWxtRXRhTGFiZWwuY2xhc3NMaXN0LmFkZChjbGFzc0Zvck5vcm5hbE1vZGVGb3JlKTtcbiAgICAgICAgICAgIHRoaXMuZWxtT2Zmc2V0LmNsYXNzTGlzdC5hZGQoY2xhc3NGb3JOb3JuYWxNb2RlRm9yZSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHBhcnRpYWwgPSB7XCJtb2RlX2ZyaWVuZFwiOiBtb2RlRnJpZW5kfTtcbiAgICAgICAgdGhpcy5jb25maWcuc2F2ZShwYXJ0aWFsKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMudXBkYXRlKGZhbHNlKTtcbiAgICB9XG59XG5cbndpbmRvdy5vbmxvYWQgPSAoKSA9PiB7XG4gICAgdmFyIGFwcCA9IG5ldyBBcHAoKTtcbiAgICBhcHAudXBkYXRlKHRydWUpO1xufTsiLCJjbGFzcyBTYWxtb25ydW5UaW1lVGltZXIge1xuICAgIGNvbnN0cnVjdG9yKHRpbWVfb2Zmc2V0ID0gbnVsbCkge1xuICAgICAgICB0aGlzLnRpbWVfb2Zmc2V0ID0gdGltZV9vZmZzZXQ7XG4gICAgfVxuXG4gICAgLy8g44OG44K544OI44GX44KE44GZ44GE44KI44GG44Gr5Z+65rqW44Gu5pel5pmC44KS5rih44Gb44KL44KI44GG44Gr44GX44GfXG4gICAgbGlzdHVwX25leHRfU1RUKGRhdGUgPSBEYXRlLm5vdygpKSB7XG4gICAgICAgIHZhciBsaXN0ID0gW107XG4gICAgICAgIHZhciBiYXNlO1xuICAgICAgICBpZiAodGhpcy50aW1lX29mZnNldCkge1xuICAgICAgICAgICAgYmFzZSA9IHRoaXMudGltZV9vZmZzZXQuZ2V0X3RpbWUoZGF0ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBiYXNlID0gbmV3IERhdGUoZGF0ZSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gIHBlcmlvZCB8ICAgMCAgIHwgICAgICAgICAgICAxICAgICAgICAgICAgfCAyICAuLi4gIDYgfCAgICAgICAgICAgIDcgICAgICAgICAgICB8IDhcbiAgICAgICAgLy8gbWludXRlcyB8IDAwIDAxIHwgMDIgMDMgMDQgMDUgMDYgMDcgMDggMDkgfCAxMCAuLi4gNDkgfCA1MCA1MSA1MiA1MyA1NCA1NSA1NiA1NyB8IDU4IDU5XG4gICAgICAgIHZhciBwZXJpb2QgPSBNYXRoLmZsb29yKCAoYmFzZS5nZXRNaW51dGVzKCkgLSAyKSAvIDgpICsgMTsgLy8gaXQgYmVjb21lcyAwIHRvIDhcbiAgICAgICAgXG4gICAgICAgIC8vIGluIHRoaXMgaG91ciAodXB0byAxc3QoOjAyKSwybmQoOjEwKSwgLi4uICw3dGgoOjUwKSlcbiAgICAgICAgdmFyIGhvdXJzID0gYmFzZS5nZXRIb3VycygpO1xuXG4gICAgICAgIC8vIGl0ZXJhdGUgYWJvdXQgaG91cnNcbiAgICAgICAgZm9yKDsgbGlzdC5sZW5ndGggPCA3OyApIHtcbiAgICAgICAgICAgIC8vIGluIHRoaXMgaG91clxuICAgICAgICAgICAgLy8gaSDjgYwgOCDjgarjgonmrKHjga7mmYLplpPjgbjjgIHjgoLjgZfjgY/jga8gNyDku7bln4vjgb7jgozjgbDntYLkuoZcbiAgICAgICAgICAgIGZvcih2YXIgaSA9IHBlcmlvZCsxOyBpIDw9IDcgJiYgbGlzdC5sZW5ndGggPCA3OyArK2kpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWludXRlcyA9IDIgKyAoaS0xKSAqIDg7XG4gICAgICAgICAgICAgICAgdmFyIGQgPSBuZXcgRGF0ZShiYXNlKTtcbiAgICAgICAgICAgICAgICBkLnNldEhvdXJzKGhvdXJzKTtcbiAgICAgICAgICAgICAgICBkLnNldE1pbnV0ZXMobWludXRlcyk7XG4gICAgICAgICAgICAgICAgZC5zZXRTZWNvbmRzKDApO1xuICAgICAgICAgICAgICAgIGQuc2V0TWlsbGlzZWNvbmRzKDApO1xuICAgICAgICAgICAgICAgIGxpc3QucHVzaCggZCApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gZm9yIG5leHQgaG91clxuICAgICAgICAgICAgcGVyaW9kID0gMDtcbiAgICAgICAgICAgIGhvdXJzICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGxpc3Q7XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBTYWxtb25ydW5UaW1lVGltZXI7IiwiLy8gYmFzZWQgb24gaHR0cHM6Ly93d3cubmljdC5nby5qcC9KU1QvSlNUNS5qc1xuXG52YXIgU2VydmVyTGlzdCA9IFtcbiAgICBcImh0dHBzOi8vbnRwLWExLm5pY3QuZ28uanAvY2dpLWJpbi9qc29uXCIsXG4gICAgXCJodHRwczovL250cC1iMS5uaWN0LmdvLmpwL2NnaS1iaW4vanNvblwiLFxuICAgIFwiaHR0cHM6Ly9udHAtYTQubmljdC5nby5qcC9jZ2ktYmluL2pzb25cIlxuXTtcbmltcG9ydCBnZXRKU09OIGZyb20gXCJnZXQtanNvbi1kYXRhXCI7XG5cbmNsYXNzIFRpbWVPZmZzZXQge1xuICAgIGNvbnN0cnVjdG9yKG9mZnNldF9mcmllbmQgPSAwKSB7XG4gICAgICAgIHRoaXMub2Zmc2V0X2pzdCA9IDA7XG4gICAgICAgIHRoaXMuc2V0X29mZnNldF9mcmllbmQob2Zmc2V0X2ZyaWVuZCk7XG4gICAgICAgIHRoaXMuZ2V0X29mZnNldF9qc3QoKTtcbiAgICB9XG5cbiAgICBnZXRfdGltZShkYXRlID0gRGF0ZS5ub3coKSkge1xuICAgICAgICB2YXIgb2Zmc2V0ID0gMDtcbiAgICAgICAgaWYgKHRoaXMub2Zmc2V0X2pzdCkgeyBvZmZzZXQgKz0gdGhpcy5vZmZzZXRfanN0OyB9XG4gICAgICAgIGlmICh0aGlzLm9mZnNldF9mcmllbmQgKSB7IG9mZnNldCArPSB0aGlzLm9mZnNldF9mcmllbmQgOyB9XG4gICAgICAgIHJldHVybiBuZXcgRGF0ZShkYXRlICsgb2Zmc2V0KTtcbiAgICB9XG4gICAgXG4gICAgc2V0X29mZnNldF9mcmllbmQob2Zmc2V0X2ZyaWVuZCkge1xuICAgICAgICB0aGlzLm9mZnNldF9mcmllbmQgPSBvZmZzZXRfZnJpZW5kO1xuICAgIH1cblxuICAgIGdldF9vZmZzZXRfanN0KCkge1xuICAgICAgICB0aGlzLnJlc3VsdHMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgY29uc3Qgc2VydmVyX25vID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMyk7XG4gICAgICAgIGNvbnN0IHNlcnZlcl9hZGRyID0gU2VydmVyTGlzdFtzZXJ2ZXJfbm9dO1xuICAgICAgICAvLyDjg6njg7Pjg4Djg6DjgafkuIDjgaTjga7jgrXjg7zjg5DjgavjgqLjgq/jgrvjgrnjgZnjgozjgbDljYHliIZcbiAgICAgICAgZ2V0SlNPTihzZXJ2ZXJfYWRkciArIFwiP1wiICsgKCAobmV3IERhdGUoKSkuZ2V0VGltZSgpIC8gMTAwMCApLCAoZXJyLCBqc29uKSA9PiB7XG4gICAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhTdHJpbmcoZXJyKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG5vdyA9IG5ldyBEYXRlKCk7XHQgXHRcdC8vIFJlY2VpdmUgdGltZVxuICAgICAgICAgICAgaWYoIGpzb24uc3QgJiYganNvbi5pdCAmJiBqc29uLmxlYXAgJiYganNvbi5uZXh0ICYmIGpzb24uc3RlcCApIHtcbiAgICAgICAgICAgICAgICBqc29uLnJ0ID0gbm93LmdldFRpbWUoKTsgXHRcdC8vIFJlY2VpdmUgdGltZVxuICAgICAgICAgICAgICAgIGpzb24uaXQgPSBOdW1iZXIoanNvbi5pdCkgKiAxMDAwOyBcdC8vIEluaXRpYXRlIHRpbWVcbiAgICAgICAgICAgICAgICBqc29uLnN0ID0gTnVtYmVyKGpzb24uc3QpICogMTAwMDsgXHQvLyBTZW5kIHRpbWVcbiAgICAgICAgICAgICAgICBqc29uLmxiID0ganNvbi5pdCAtIDE2IC0ganNvbi5zdDtcdC8vIGVzdGltYXRlZCBsb3dlciBib3VuZFxuICAgICAgICAgICAgICAgIGpzb24udWIgPSBqc29uLnJ0ICsgMTYgLSBqc29uLnN0O1x0Ly8gZXN0aW1hdGVkIHVwcGVyIGJvdW5kXG5cbiAgICAgICAgICAgICAgICAvLyDoqbDjgb7jgovjgajjgZPjgo3lv4XopoHjgarjga7jga/kuK3lpK7jga7kv67mraPlgKTjgaDjgZFcbiAgICAgICAgICAgICAgICB0aGlzLm9mZnNldF9qc3QgPSAtICgganNvbi5sYiArIGpzb24udWIgKSAvIDI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuXG5leHBvcnQgZGVmYXVsdCBUaW1lT2Zmc2V0OyJdLCJzb3VyY2VSb290IjoiIn0=